(()=>{var e={};e.id=64,e.ids=[64],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},552:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>m,pages:()=>c,routeModule:()=>x,tree:()=>d});var a=t(482),n=t(9108),l=t(2563),i=t.n(l),r=t(8300),o={};for(let e in r)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>r[e]);t.d(s,o);let d=["",{children:["appointments",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,7766)),"D:\\Download\\beauty-center-demo\\src\\app\\appointments\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,1403)),"D:\\Download\\beauty-center-demo\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9361,23)),"next/dist/client/components/not-found-error"]}],c=["D:\\Download\\beauty-center-demo\\src\\app\\appointments\\page.tsx"],m="/appointments/page",p={require:t,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/appointments/page",pathname:"/appointments",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},1796:(e,s,t)=>{Promise.resolve().then(t.bind(t,5478))},6469:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(9224).Z)("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]])},8638:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(9224).Z)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]])},2312:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(9224).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},5545:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(9224).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},5674:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(9224).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},8411:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(9224).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},6075:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(9224).Z)("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]])},626:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(9224).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},1838:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(9224).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},9599:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(9224).Z)("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]])},5478:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>Z});var a=t(5344),n=t(3729),l=t(8428),i=t(2017),r=t(726),o=t(3538),d=t(9795),c=t(1453),m=t(1838),p=t(9224);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let x=(0,p.Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);var u=t(5794);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let h=(0,p.Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var g=t(5545),v=t(8822),f=t(626),b=t(2312),j=t(6075),y=t(4513);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let _=(0,p.Z)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);var N=t(8411),w=t(4243),k=t(6469),C=t(8638),$=t(5674),S=t(9599);function Z(){let e=(0,l.useRouter)(),{user:s,isAuthenticated:t}=(0,i.t)(),{appointments:p,customers:Z,services:P,users:M,settings:z,addAppointment:D,updateAppointment:q,searchCustomers:T,bills:G,addBill:I,addTransaction:A}=(0,i.a)(),{locale:R,t:E}=(0,r.useI18n)(),[L,X]=(0,n.useState)(""),[O,F]=(0,n.useState)(""),[B,H]=(0,n.useState)(new Date().toISOString().split("T")[0]),[U,V]=(0,n.useState)(!1),[Y,Q]=(0,n.useState)(!1),[J,K]=(0,n.useState)(!1),[W,ee]=(0,n.useState)(null),[es,et]=(0,n.useState)(null),[ea,en]=(0,n.useState)(null),[el,ei]=(0,n.useState)("cash"),[er,eo]=(0,n.useState)(""),[ed,ec]=(0,n.useState)(!1),[em,ep]=(0,n.useState)([]),[ex,eu]=(0,n.useState)({customer_id:"",customer_name:"",customer_phone:"",service_id:"",price:"",discount:"0",staff_id:"",appointment_date:"",appointment_time:"09:00",notes:""});if((0,n.useEffect)(()=>{t||e.push("/login")},[t,e]),!t)return null;let eh=M.filter(e=>"staff"===e.role&&e.is_active);(0,n.useEffect)(()=>{er.length>=2?(ep(T(er)),ec(!0)):(ep([]),ec(!1))},[er,T]);let eg=(0,n.useMemo)(()=>p.filter(e=>{let s=e.customer_name.toLowerCase().includes(L.toLowerCase())||e.service_name.toLowerCase().includes(L.toLowerCase()),t=!O||e.status===O,a=e.appointment_date===B;return s&&t&&a}).sort((e,s)=>e.appointment_time.localeCompare(s.appointment_time)),[p,L,O,B]),ev=(0,n.useMemo)(()=>{let e=p.filter(e=>e.appointment_date===B);return{total:e.length,pending:e.filter(e=>"pending"===e.status).length,confirmed:e.filter(e=>"confirmed"===e.status).length,in_progress:e.filter(e=>"in_progress"===e.status).length,completed:e.filter(e=>"done"===e.status).length,revenue:e.filter(e=>"done"===e.status).reduce((e,s)=>e+s.total_price,0)}},[p,B]),ef=e=>{let s=new Date(B);s.setDate(s.getDate()+e),H(s.toISOString().split("T")[0])},eb=e=>{let s=P.find(s=>s.id===Number(e));s&&eu(t=>({...t,service_id:e,price:String(s.price)}))},ej=e=>{eu(s=>({...s,customer_id:String(e.id),customer_name:e.name,customer_phone:e.phone})),eo(e.name),ec(!1)},ey=e=>{et(e),ei("cash"),Q(!0)},e_=e=>{let s=G.find(s=>s.appointment_id===e.id);s&&(ee(s),K(!0))},eN=e=>{e?(en(e),eo(e.customer_name),eu({customer_id:String(e.customer_id),customer_name:e.customer_name,customer_phone:e.customer_phone,service_id:String(e.service_id),price:String(e.price),discount:String(e.discount||0),staff_id:String(e.staff_id),appointment_date:e.appointment_date,appointment_time:e.appointment_time,notes:e.notes||""})):(en(null),eo(""),eu({customer_id:"",customer_name:"",customer_phone:"",service_id:"",price:"",discount:"0",staff_id:"",appointment_date:B,appointment_time:"09:00",notes:""})),V(!0)},ew=()=>{V(!1),en(null),eo(""),ec(!1)},ek=e=>a.jsx(d.Ct,{variant:{done:"success",confirmed:"info",in_progress:"info",pending:"warning",cancelled:"danger"}[e]||"default",children:(0,c.li)(e,R)}),eC=e=>({cash:{en:"Cash",lo:"ເງິນສົດ"},transfer:{en:"Bank Transfer",lo:"ໂອນເງິນ"},card:{en:"Credit/Debit Card",lo:"ບັດເຄຣດິດ/ເດບິດ"}})[e]?.["lo"===R?"lo":"en"]||e;return a.jsx(o.Z,{children:(0,a.jsxs)("div",{className:"space-y-6 animate-fadeIn",children:[a.jsx(d.mr,{title:E("appointments.title"),subtitle:"lo"===R?"ຈັດການນັດໝາຍລູກຄ້າ":"Manage customer appointments",action:a.jsx(d.zx,{icon:a.jsx(m.Z,{className:"w-5 h-5"}),onClick:()=>eN(),children:E("appointments.add")})}),a.jsx(d.Zb,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>ef(-1),className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(x,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-rose-50 rounded-lg",children:[a.jsx(u.Z,{className:"w-5 h-5 text-rose-500"}),a.jsx("span",{className:"font-semibold text-gray-900",children:new Date(B).toLocaleDateString("lo"===R?"lo-LA":"en-US",{weekday:"long",day:"numeric",month:"long",year:"numeric"})})]}),a.jsx("button",{onClick:()=>ef(1),className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(h,{className:"w-5 h-5"})}),a.jsx("input",{type:"date",value:B,onChange:e=>H(e.target.value),className:"px-3 py-2 border rounded-lg text-sm"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,a.jsxs)("span",{className:"text-gray-500",children:["lo"===R?"ທັງໝົດ":"Total",": ",a.jsx("strong",{children:(0,c.uf)(ev.total)})]}),(0,a.jsxs)("span",{className:"text-amber-600",children:["lo"===R?"ລໍຖ້າ":"Pending",": ",a.jsx("strong",{children:(0,c.uf)(ev.pending)})]}),(0,a.jsxs)("span",{className:"text-blue-600",children:["lo"===R?"ກຳລັງເຮັດ":"In Progress",": ",a.jsx("strong",{children:(0,c.uf)(ev.in_progress)})]}),(0,a.jsxs)("span",{className:"text-emerald-600",children:["lo"===R?"ສຳເລັດ":"Done",": ",a.jsx("strong",{children:(0,c.uf)(ev.completed)})]}),a.jsx("span",{className:"text-rose-600 font-bold",children:(0,c.xG)(ev.revenue)})]})]})}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsx(d.Mj,{value:L,onChange:X,placeholder:E("common.search")})}),(0,a.jsxs)("select",{value:O,onChange:e=>F(e.target.value),className:"px-4 py-2.5 border rounded-lg bg-white",children:[(0,a.jsxs)("option",{value:"",children:[E("common.all")," ","lo"===R?"ສະຖານະ":"Status"]}),a.jsx("option",{value:"pending",children:(0,c.li)("pending",R)}),a.jsx("option",{value:"confirmed",children:(0,c.li)("confirmed",R)}),a.jsx("option",{value:"in_progress",children:(0,c.li)("in_progress",R)}),a.jsx("option",{value:"done",children:(0,c.li)("done",R)}),a.jsx("option",{value:"cancelled",children:(0,c.li)("cancelled",R)})]})]}),a.jsx("div",{className:"space-y-3",children:0===eg.length?a.jsx(d.Zb,{children:a.jsx(d.ub,{icon:a.jsx(u.Z,{className:"w-8 h-8"}),title:"lo"===R?"ບໍ່ມີນັດໝາຍ":"No appointments",action:a.jsx(d.zx,{onClick:()=>eN(),children:E("appointments.add")})})}):eg.map(e=>a.jsx(d.Zb,{hover:!0,className:"p-0 overflow-hidden",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsxs)("div",{className:`w-24 sm:w-28 p-4 flex flex-col items-center justify-center text-white ${"done"===e.status?"bg-gradient-to-br from-emerald-500 to-green-600":"cancelled"===e.status?"bg-gradient-to-br from-gray-400 to-gray-500":"bg-gradient-to-br from-rose-500 to-pink-500"}`,children:[a.jsx(g.Z,{className:"w-5 h-5 mb-1 opacity-80"}),a.jsx("span",{className:"text-xl font-bold",children:e.appointment_time.substring(0,5)}),(0,a.jsxs)("span",{className:"text-xs opacity-80",children:[e.duration," ","lo"===R?"ນາທີ":"min"]})]}),a.jsx("div",{className:"flex-1 p-4",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(v.Z,{className:"w-4 h-4 text-gray-400"}),a.jsx("span",{className:"font-semibold text-gray-900",children:e.customer_name}),ek(e.status)]}),a.jsx("p",{className:"text-sm text-rose-600 font-medium",children:"lo"===R?e.service_name_lo:e.service_name}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[a.jsx(f.Z,{className:"w-3 h-3"})," ",e.customer_phone]}),(0,a.jsxs)("span",{children:["lo"===R?"ພະນັກງານ":"Staff",": ",e.staff_name]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"text-right mr-2",children:[a.jsx("span",{className:"text-lg font-bold text-gray-900",children:(0,c.xG)(e.total_price)}),e.discount>0&&(0,a.jsxs)("p",{className:"text-xs text-red-500",children:["-",(0,c.xG)(e.discount)]})]}),"pending"===e.status&&(0,a.jsxs)(a.Fragment,{children:[a.jsx("button",{onClick:()=>q(e.id,{status:"confirmed"}),className:"p-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100",title:"lo"===R?"ຢືນຢັນ":"Confirm",children:a.jsx(b.Z,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>eN(e),className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(j.Z,{className:"w-4 h-4 text-gray-500"})}),a.jsx("button",{onClick:()=>q(e.id,{status:"cancelled"}),className:"p-2 hover:bg-red-50 rounded-lg",children:a.jsx(y.Z,{className:"w-4 h-4 text-red-500"})})]}),"confirmed"===e.status&&(0,a.jsxs)(a.Fragment,{children:[a.jsx("button",{onClick:()=>q(e.id,{status:"in_progress"}),className:"p-2 bg-amber-50 text-amber-600 rounded-lg hover:bg-amber-100",title:"lo"===R?"ເລີ່ມ":"Start",children:a.jsx(_,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>eN(e),className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(j.Z,{className:"w-4 h-4 text-gray-500"})}),a.jsx("button",{onClick:()=>q(e.id,{status:"cancelled"}),className:"p-2 hover:bg-red-50 rounded-lg",children:a.jsx(y.Z,{className:"w-4 h-4 text-red-500"})})]}),"in_progress"===e.status&&(0,a.jsxs)(a.Fragment,{children:[a.jsx(d.zx,{size:"sm",variant:"success",icon:a.jsx(N.Z,{className:"w-4 h-4"}),onClick:()=>ey(e),children:"lo"===R?"ຮັບເງິນ":"Payment"}),a.jsx("button",{onClick:()=>q(e.id,{status:"cancelled"}),className:"p-2 hover:bg-red-50 rounded-lg",children:a.jsx(y.Z,{className:"w-4 h-4 text-red-500"})})]}),"done"===e.status&&a.jsx(d.zx,{size:"sm",variant:"secondary",icon:a.jsx(w.Z,{className:"w-4 h-4"}),onClick:()=>e_(e),children:"lo"===R?"ໃບເສັດ":"Receipt"})]})]})})]})},e.id))}),a.jsx(d.u_,{isOpen:U,onClose:ew,title:E(ea?"common.edit":"appointments.add"),size:"lg",children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();let s=P.find(e=>e.id===Number(ex.service_id)),t=M.find(e=>e.id===Number(ex.staff_id)),a=Number(ex.price),n=Number(ex.discount)||0,l={customer_id:Number(ex.customer_id),customer_name:ex.customer_name,customer_phone:ex.customer_phone,service_id:Number(ex.service_id),service_name:s?.name||"",service_name_lo:s?.name_lo||"",staff_id:Number(ex.staff_id),staff_name:t?.full_name||"",appointment_date:ex.appointment_date,appointment_time:ex.appointment_time,duration:s?.duration||60,price:a,discount:n,total_price:a-n,status:"pending",notes:ex.notes};ea?q(ea.id,l):D(l),ew()},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[E("appointments.customer")," *"]}),a.jsx("input",{type:"text",value:er,onChange:e=>eo(e.target.value),className:"w-full px-4 py-2.5 border rounded-lg",placeholder:"lo"===R?"ຄົ້ນຫາລູກຄ້າ...":"Search customer...",required:!0}),ed&&em.length>0&&a.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-60 overflow-y-auto",children:em.map(e=>(0,a.jsxs)("button",{type:"button",onClick:()=>ej(e),className:"w-full px-4 py-2 text-left hover:bg-gray-50 flex justify-between",children:[a.jsx("span",{className:"font-medium",children:e.name}),a.jsx("span",{className:"text-gray-500 text-sm",children:e.phone})]},e.id))})]}),a.jsx(d.Ph,{label:E("appointments.service"),value:ex.service_id,onChange:e=>eb(e.target.value),options:P.filter(e=>e.is_active).map(e=>({value:e.id,label:`${"lo"===R?e.name_lo:e.name} - ${(0,c.xG)(e.price)}`})),placeholder:`-- ${"lo"===R?"ເລືອກບໍລິການ":"Select Service"} --`,required:!0}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx(d.II,{label:"lo"===R?"ລາຄາ":"Price",type:"number",value:ex.price,onChange:e=>eu({...ex,price:e.target.value}),required:!0}),a.jsx(d.II,{label:"lo"===R?"ສ່ວນຫຼຸດ":"Discount",type:"number",value:ex.discount,onChange:e=>eu({...ex,discount:e.target.value})})]}),a.jsx(d.Ph,{label:E("appointments.staff"),value:ex.staff_id,onChange:e=>eu({...ex,staff_id:e.target.value}),options:eh.map(e=>({value:e.id,label:e.full_name})),placeholder:`-- ${"lo"===R?"ເລືອກພະນັກງານ":"Select Staff"} --`,required:!0}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx(d.II,{label:E("appointments.date"),type:"date",value:ex.appointment_date,onChange:e=>eu({...ex,appointment_date:e.target.value}),required:!0}),a.jsx(d.II,{label:E("appointments.time"),type:"time",value:ex.appointment_time,onChange:e=>eu({...ex,appointment_time:e.target.value}),required:!0})]}),a.jsx(d.II,{label:"lo"===R?"ໝາຍເຫດ":"Notes",value:ex.notes,onChange:e=>eu({...ex,notes:e.target.value})}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[a.jsx(d.zx,{type:"button",variant:"secondary",className:"flex-1",onClick:ew,children:E("common.cancel")}),a.jsx(d.zx,{type:"submit",className:"flex-1",children:E("common.save")})]})]})}),a.jsx(d.u_,{isOpen:Y,onClose:()=>Q(!1),title:"lo"===R?"ຮັບເງິນ":"Receive Payment",size:"md",children:es&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-xl",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-2",children:[a.jsx("span",{className:"text-gray-600",children:"lo"===R?"ລູກຄ້າ":"Customer"}),a.jsx("span",{className:"font-medium",children:es.customer_name})]}),(0,a.jsxs)("div",{className:"flex justify-between mb-2",children:[a.jsx("span",{className:"text-gray-600",children:"lo"===R?"ບໍລິການ":"Service"}),a.jsx("span",{className:"font-medium",children:"lo"===R?es.service_name_lo:es.service_name})]}),(0,a.jsxs)("div",{className:"border-t pt-2 mt-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"lo"===R?"ລາຄາ":"Price"}),a.jsx("span",{children:(0,c.xG)(es.price)})]}),es.discount>0&&(0,a.jsxs)("div",{className:"flex justify-between text-red-600",children:[a.jsx("span",{children:"lo"===R?"ສ່ວນຫຼຸດ":"Discount"}),(0,a.jsxs)("span",{children:["-",(0,c.xG)(es.discount)]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{className:"text-gray-600",children:["lo"===R?"ອາກອນ":"Tax"," (",z.tax_rate,"%)"]}),a.jsx("span",{children:(0,c.xG)(Math.round((es.price-(es.discount||0))*z.tax_rate/100))})]}),(0,a.jsxs)("div",{className:"flex justify-between text-xl font-bold mt-2 pt-2 border-t",children:[a.jsx("span",{children:"lo"===R?"ຍອດລວມ":"Total"}),a.jsx("span",{className:"text-rose-600",children:(0,c.xG)(es.price-(es.discount||0)+Math.round((es.price-(es.discount||0))*z.tax_rate/100))})]})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"lo"===R?"ວິທີຊຳລະ":"Payment Method"}),a.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{value:"cash",label:"lo"===R?"ເງິນສົດ":"Cash",icon:k.Z,color:"emerald"},{value:"transfer",label:"lo"===R?"ໂອນ":"Transfer",icon:C.Z,color:"blue"},{value:"card",label:"lo"===R?"ບັດ":"Card",icon:$.Z,color:"purple"}].map(e=>(0,a.jsxs)("button",{type:"button",onClick:()=>ei(e.value),className:`p-4 rounded-xl border-2 transition-all flex flex-col items-center gap-2 ${el===e.value?`border-${e.color}-500 bg-${e.color}-50`:"border-gray-200 hover:border-gray-300"}`,children:[a.jsx(e.icon,{className:`w-6 h-6 ${el===e.value?`text-${e.color}-600`:"text-gray-400"}`}),a.jsx("span",{className:`text-sm font-medium ${el===e.value?`text-${e.color}-700`:"text-gray-600"}`,children:e.label})]},e.value))})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[a.jsx(d.zx,{type:"button",variant:"secondary",className:"flex-1",onClick:()=>Q(!1),children:"lo"===R?"ຍົກເລີກ":"Cancel"}),a.jsx(d.zx,{type:"button",variant:"success",className:"flex-1",icon:a.jsx(N.Z,{className:"w-5 h-5"}),onClick:()=>{if(!es)return;let e=es.price,t=es.discount||0,a=e-t,n=Math.round(a*z.tax_rate/100),l=a+n,i={id:Math.max(...G.map(e=>e.id),0)+1,bill_number:`RCP-${new Date().getFullYear()}-${String(G.length+1).padStart(5,"0")}`,appointment_id:es.id,customer_id:es.customer_id,customer_name:es.customer_name,customer_phone:es.customer_phone,service_id:es.service_id,service_name:es.service_name,service_name_lo:es.service_name_lo,staff_id:es.staff_id,staff_name:es.staff_name,subtotal:e,discount_amount:t,tax_rate:z.tax_rate,tax_amount:n,grand_total:l,payment_method:el,payment_status:"paid",notes:"",created_at:new Date().toISOString().split("T")[0],created_time:new Date().toTimeString().substring(0,5)};q(es.id,{status:"done"}),I(i),A({type:"income",category_id:0,category_name:"Service",description:`${es.service_name} - ${es.customer_name}`,amount:l,payment_method:el,bill_id:i.id,created_by:s?.id||1,created_by_name:s?.full_name||"Admin"}),Q(!1),ee(i),K(!0)},children:"lo"===R?"ຢືນຢັນການຮັບເງິນ":"Confirm Payment"})]})]})}),a.jsx(d.u_,{isOpen:J,onClose:()=>K(!1),title:`${"lo"===R?"ໃບຮັບເງິນ":"Receipt"}`,size:"md",children:W&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"bg-white border rounded-xl p-6 font-mono text-sm max-h-[60vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"text-center border-b pb-4 mb-4",children:[a.jsx("h2",{className:"text-lg font-bold",children:z.shop_name}),a.jsx("p",{className:"text-gray-600",children:z.shop_name_lo}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:z.address}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["Tel: ",z.phone]})]}),(0,a.jsxs)("div",{className:"text-center mb-4",children:[a.jsx("p",{className:"text-base font-bold",children:"lo"===R?"ໃບຮັບເງິນ":"RECEIPT"}),(0,a.jsxs)("p",{className:"text-lg font-bold text-rose-600",children:["#",W.bill_number]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[W.created_at," ",W.created_time||""]})]}),(0,a.jsxs)("div",{className:"border-t border-dashed pt-3 mb-3 space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{className:"text-gray-500",children:["lo"===R?"ລູກຄ້າ":"Customer",":"]}),a.jsx("span",{className:"font-medium",children:W.customer_name})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{className:"text-gray-500",children:["lo"===R?"ເບີໂທ":"Phone",":"]}),a.jsx("span",{children:W.customer_phone})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{className:"text-gray-500",children:["lo"===R?"ພະນັກງານ":"Staff",":"]}),a.jsx("span",{children:W.staff_name})]})]}),(0,a.jsxs)("div",{className:"border-t border-b border-dashed py-3 mb-3",children:[a.jsx("p",{className:"font-medium",children:"lo"===R?W.service_name_lo:W.service_name}),a.jsx("p",{className:"text-right font-medium",children:(0,c.xG)(W.subtotal)})]}),(0,a.jsxs)("div",{className:"space-y-1 mb-3",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-500",children:"lo"===R?"ລາຄາ":"Subtotal"}),a.jsx("span",{children:(0,c.xG)(W.subtotal)})]}),W.discount_amount>0&&(0,a.jsxs)("div",{className:"flex justify-between text-red-600",children:[a.jsx("span",{children:"lo"===R?"ສ່ວນຫຼຸດ":"Discount"}),(0,a.jsxs)("span",{children:["-",(0,c.xG)(W.discount_amount)]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{className:"text-gray-500",children:["lo"===R?"ອາກອນ":"VAT"," (",W.tax_rate,"%)"]}),a.jsx("span",{children:(0,c.xG)(W.tax_amount)})]})]}),a.jsx("div",{className:"bg-gray-100 -mx-6 px-6 py-3 mb-3",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-lg font-bold",children:"lo"===R?"ຍອດລວມ":"GRAND TOTAL"}),a.jsx("span",{className:"text-2xl font-bold text-rose-600",children:(0,c.xG)(W.grand_total)})]})}),(0,a.jsxs)("div",{className:"space-y-1 mb-4",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-500",children:"lo"===R?"ຊຳລະດ້ວຍ":"Paid by"}),a.jsx("span",{className:"font-medium",children:eC(W.payment_method)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-500",children:"lo"===R?"ສະຖານະ":"Status"}),(0,a.jsxs)("span",{className:"text-emerald-600 font-bold",children:["✓ ","lo"===R?"ຊຳລະແລ້ວ":"PAID"]})]})]}),(0,a.jsxs)("div",{className:"text-center border-t pt-4 text-xs text-gray-500",children:[a.jsx("p",{className:"font-medium",children:"lo"===R?"ຂອບໃຈທີ່ໃຊ້ບໍລິການ":"Thank you for your visit!"}),a.jsx("p",{className:"mt-2",children:"lo"===R?"ກະລຸນາເກັບໄວ້ເປັນຫຼັກຖານ":"Please keep for your records"})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 mt-4",children:[a.jsx(d.zx,{variant:"secondary",className:"flex-1",onClick:()=>K(!1),children:"lo"===R?"ປິດ":"Close"}),a.jsx(d.zx,{className:"flex-1",icon:a.jsx(S.Z,{className:"w-5 h-5"}),onClick:()=>{let e=window.open("","_blank");e&&W&&(e.document.write(`
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Receipt #${W.bill_number}</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { 
      font-family: 'Courier New', monospace; 
      font-size: 12px; 
      width: 80mm; 
      margin: 0 auto; 
      padding: 8mm 4mm;
      line-height: 1.4;
    }
    .center { text-align: center; }
    .right { text-align: right; }
    .bold { font-weight: bold; }
    .shop-name { font-size: 16px; font-weight: bold; margin-bottom: 2px; }
    .shop-info { font-size: 10px; color: #555; }
    .divider { border-top: 1px dashed #000; margin: 8px 0; }
    .double-divider { border-top: 2px solid #000; margin: 8px 0; }
    .bill-no { font-size: 14px; font-weight: bold; margin: 8px 0; letter-spacing: 1px; }
    .row { display: flex; justify-content: space-between; margin: 3px 0; }
    .label { color: #555; }
    .total-section { background: #f5f5f5; padding: 8px; margin: 8px -4mm; }
    .grand-total { font-size: 18px; font-weight: bold; }
    .footer { font-size: 10px; color: #555; margin-top: 12px; }
    .qr-placeholder { width: 60px; height: 60px; border: 1px dashed #999; margin: 8px auto; display: flex; align-items: center; justify-content: center; font-size: 8px; color: #999; }
  </style>
</head>
<body>
  <div class="center">
    <div class="shop-name">${z.shop_name}</div>
    <div class="shop-name">${z.shop_name_lo}</div>
    <div class="shop-info">${z.address}</div>
    <div class="shop-info">Tel: ${z.phone}</div>
  </div>
  
  <div class="divider"></div>
  
  <div class="center">
    <div style="font-size: 14px; font-weight: bold;">ໃບຮັບເງິນ / RECEIPT</div>
    <div class="bill-no">#${W.bill_number}</div>
    <div style="font-size: 10px; color: #555;">${W.created_at} ${W.created_time||""}</div>
  </div>
  
  <div class="divider"></div>
  
  <div class="row"><span class="label">${"lo"===R?"ລູກຄ້າ":"Customer"}:</span><span class="bold">${W.customer_name}</span></div>
  <div class="row"><span class="label">${"lo"===R?"ເບີໂທ":"Phone"}:</span><span>${W.customer_phone}</span></div>
  <div class="row"><span class="label">${"lo"===R?"ພະນັກງານ":"Staff"}:</span><span>${W.staff_name}</span></div>
  
  <div class="double-divider"></div>
  
  <div style="margin-bottom: 4px;">
    <div class="bold">${"lo"===R?W.service_name_lo:W.service_name}</div>
    <div class="right" style="margin-top: -14px;">${(0,c.xG)(W.subtotal)}</div>
  </div>
  
  <div class="divider"></div>
  
  <div class="row"><span class="label">${"lo"===R?"ລາຄາ":"Subtotal"}</span><span>${(0,c.xG)(W.subtotal)}</span></div>
  ${W.discount_amount>0?`<div class="row" style="color: #e11d48;"><span>${"lo"===R?"ສ່ວນຫຼຸດ":"Discount"}</span><span>-${(0,c.xG)(W.discount_amount)}</span></div>`:""}
  <div class="row"><span class="label">${"lo"===R?"ອາກອນ":"VAT"} (${W.tax_rate}%)</span><span>${(0,c.xG)(W.tax_amount)}</span></div>
  
  <div class="total-section">
    <div class="row grand-total">
      <span>${"lo"===R?"ຍອດລວມ":"GRAND TOTAL"}</span>
      <span>${(0,c.xG)(W.grand_total)}</span>
    </div>
  </div>
  
  <div class="row"><span class="label">${"lo"===R?"ຊຳລະດ້ວຍ":"Paid by"}</span><span class="bold">${eC(W.payment_method)}</span></div>
  <div class="row"><span class="label">${"lo"===R?"ສະຖານະ":"Status"}</span><span style="color: #059669;" class="bold">✓ ${"lo"===R?"ຊຳລະແລ້ວ":"PAID"}</span></div>
  
  <div class="divider"></div>
  
  <div class="center footer">
    <p>${"lo"===R?"ຂອບໃຈທີ່ໃຊ້ບໍລິການ":"Thank you for your visit!"}</p>
    <p>ເລກປະຈຳຕົວຜູ້ເສຍອາກອນ: ${z.tax_id||"XXXXXXXXXX"}</p>
    <div class="qr-placeholder">QR Code</div>
    <p style="margin-top: 8px;">--- ${"lo"===R?"ກະລຸນາເກັບໄວ້ເປັນຫຼັກຖານ":"Please keep for your records"} ---</p>
  </div>
</body>
</html>
      `),e.document.close(),setTimeout(()=>{e.print()},250))},children:"lo"===R?"ພິມໃບເສັດ":"Print Receipt"})]})]})})]})})}},7766:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>l,__esModule:()=>n,default:()=>i});let a=(0,t(6843).createProxy)(String.raw`D:\Download\beauty-center-demo\src\app\appointments\page.tsx`),{__esModule:n,$$typeof:l}=a,i=a.default}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[198,635,639,104,688],()=>t(552));module.exports=a})();