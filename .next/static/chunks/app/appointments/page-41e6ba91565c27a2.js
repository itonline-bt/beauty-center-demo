(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[64],{2311:function(e,s,t){Promise.resolve().then(t.bind(t,7240))},9229:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,t(7461).Z)("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]])},3149:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,t(7461).Z)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]])},9259:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,t(7461).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},6490:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,t(7461).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},527:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,t(7461).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},8219:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,t(7461).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},5421:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,t(7461).Z)("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]])},5904:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,t(7461).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},94:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,t(7461).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},3915:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,t(7461).Z)("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]])},7240:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return z}});var n=t(3827),a=t(4090),l=t(7907),i=t(3036),c=t(9003),o=t(1965),r=t(5030),d=t(2169),m=t(94),p=t(7461);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let x=(0,p.Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);var u=t(1061);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let h=(0,p.Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var f=t(6490),v=t(1213),g=t(5904),b=t(9259),j=t(5421),y=t(2235);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let _=(0,p.Z)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);var N=t(8219),w=t(2461),k=t(9229),C=t(3149),S=t(527),Z=t(3915);function z(){let e=(0,l.useRouter)(),{user:s,isAuthenticated:t}=(0,i.t)(),{appointments:p,customers:z,services:P,users:M,settings:T,addAppointment:D,updateAppointment:G,searchCustomers:I,bills:q,addBill:R,addTransaction:A}=(0,i.a)(),{locale:L,t:O}=(0,c.useI18n)(),[E,X]=(0,a.useState)(""),[F,B]=(0,a.useState)(""),[H,U]=(0,a.useState)(new Date().toISOString().split("T")[0]),[V,Y]=(0,a.useState)(!1),[Q,J]=(0,a.useState)(!1),[K,W]=(0,a.useState)(!1),[$,ee]=(0,a.useState)(null),[es,et]=(0,a.useState)(null),[en,ea]=(0,a.useState)(null),[el,ei]=(0,a.useState)("cash"),[ec,eo]=(0,a.useState)(""),[er,ed]=(0,a.useState)(!1),[em,ep]=(0,a.useState)([]),[ex,eu]=(0,a.useState)({customer_id:"",customer_name:"",customer_phone:"",service_id:"",price:"",discount:"0",staff_id:"",appointment_date:"",appointment_time:"09:00",notes:""});if((0,a.useEffect)(()=>{t||e.push("/login")},[t,e]),!t)return null;let eh=M.filter(e=>"staff"===e.role&&e.is_active);(0,a.useEffect)(()=>{ec.length>=2?(ep(I(ec)),ed(!0)):(ep([]),ed(!1))},[ec,I]);let ef=(0,a.useMemo)(()=>p.filter(e=>{let s=e.customer_name.toLowerCase().includes(E.toLowerCase())||e.service_name.toLowerCase().includes(E.toLowerCase()),t=!F||e.status===F,n=e.appointment_date===H;return s&&t&&n}).sort((e,s)=>e.appointment_time.localeCompare(s.appointment_time)),[p,E,F,H]),ev=(0,a.useMemo)(()=>{let e=p.filter(e=>e.appointment_date===H);return{total:e.length,pending:e.filter(e=>"pending"===e.status).length,confirmed:e.filter(e=>"confirmed"===e.status).length,in_progress:e.filter(e=>"in_progress"===e.status).length,completed:e.filter(e=>"done"===e.status).length,revenue:e.filter(e=>"done"===e.status).reduce((e,s)=>e+s.total_price,0)}},[p,H]),eg=e=>{let s=new Date(H);s.setDate(s.getDate()+e),U(s.toISOString().split("T")[0])},eb=e=>{let s=P.find(s=>s.id===Number(e));s&&eu(t=>({...t,service_id:e,price:String(s.price)}))},ej=e=>{eu(s=>({...s,customer_id:String(e.id),customer_name:e.name,customer_phone:e.phone})),eo(e.name),ed(!1)},ey=e=>{et(e),ei("cash"),J(!0)},e_=e=>{let s=q.find(s=>s.appointment_id===e.id);s&&(ee(s),W(!0))},eN=e=>{e?(ea(e),eo(e.customer_name),eu({customer_id:String(e.customer_id),customer_name:e.customer_name,customer_phone:e.customer_phone,service_id:String(e.service_id),price:String(e.price),discount:String(e.discount||0),staff_id:String(e.staff_id),appointment_date:e.appointment_date,appointment_time:e.appointment_time,notes:e.notes||""})):(ea(null),eo(""),eu({customer_id:"",customer_name:"",customer_phone:"",service_id:"",price:"",discount:"0",staff_id:"",appointment_date:H,appointment_time:"09:00",notes:""})),Y(!0)},ew=()=>{Y(!1),ea(null),eo(""),ed(!1)},ek=e=>(0,n.jsx)(r.Ct,{variant:{done:"success",confirmed:"info",in_progress:"info",pending:"warning",cancelled:"danger"}[e]||"default",children:(0,d.li)(e,L)}),eC=e=>{var s;return(null===(s=({cash:{en:"Cash",lo:"ເງິນສົດ"},transfer:{en:"Bank Transfer",lo:"ໂອນເງິນ"},card:{en:"Credit/Debit Card",lo:"ບັດເຄຣດິດ/ເດບິດ"}})[e])||void 0===s?void 0:s["lo"===L?"lo":"en"])||e};return(0,n.jsx)(o.Z,{children:(0,n.jsxs)("div",{className:"space-y-6 animate-fadeIn",children:[(0,n.jsx)(r.mr,{title:O("appointments.title"),subtitle:"lo"===L?"ຈັດການນັດໝາຍລູກຄ້າ":"Manage customer appointments",action:(0,n.jsx)(r.zx,{icon:(0,n.jsx)(m.Z,{className:"w-5 h-5"}),onClick:()=>eN(),children:O("appointments.add")})}),(0,n.jsx)(r.Zb,{className:"p-4",children:(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("button",{onClick:()=>eg(-1),className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,n.jsx)(x,{className:"w-5 h-5"})}),(0,n.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-rose-50 rounded-lg",children:[(0,n.jsx)(u.Z,{className:"w-5 h-5 text-rose-500"}),(0,n.jsx)("span",{className:"font-semibold text-gray-900",children:new Date(H).toLocaleDateString("lo"===L?"lo-LA":"en-US",{weekday:"long",day:"numeric",month:"long",year:"numeric"})})]}),(0,n.jsx)("button",{onClick:()=>eg(1),className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,n.jsx)(h,{className:"w-5 h-5"})}),(0,n.jsx)("input",{type:"date",value:H,onChange:e=>U(e.target.value),className:"px-3 py-2 border rounded-lg text-sm"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,n.jsxs)("span",{className:"text-gray-500",children:["lo"===L?"ທັງໝົດ":"Total",": ",(0,n.jsx)("strong",{children:(0,d.uf)(ev.total)})]}),(0,n.jsxs)("span",{className:"text-amber-600",children:["lo"===L?"ລໍຖ້າ":"Pending",": ",(0,n.jsx)("strong",{children:(0,d.uf)(ev.pending)})]}),(0,n.jsxs)("span",{className:"text-blue-600",children:["lo"===L?"ກຳລັງເຮັດ":"In Progress",": ",(0,n.jsx)("strong",{children:(0,d.uf)(ev.in_progress)})]}),(0,n.jsxs)("span",{className:"text-emerald-600",children:["lo"===L?"ສຳເລັດ":"Done",": ",(0,n.jsx)("strong",{children:(0,d.uf)(ev.completed)})]}),(0,n.jsx)("span",{className:"text-rose-600 font-bold",children:(0,d.xG)(ev.revenue)})]})]})}),(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsx)(r.Mj,{value:E,onChange:X,placeholder:O("common.search")})}),(0,n.jsxs)("select",{value:F,onChange:e=>B(e.target.value),className:"px-4 py-2.5 border rounded-lg bg-white",children:[(0,n.jsxs)("option",{value:"",children:[O("common.all")," ","lo"===L?"ສະຖານະ":"Status"]}),(0,n.jsx)("option",{value:"pending",children:(0,d.li)("pending",L)}),(0,n.jsx)("option",{value:"confirmed",children:(0,d.li)("confirmed",L)}),(0,n.jsx)("option",{value:"in_progress",children:(0,d.li)("in_progress",L)}),(0,n.jsx)("option",{value:"done",children:(0,d.li)("done",L)}),(0,n.jsx)("option",{value:"cancelled",children:(0,d.li)("cancelled",L)})]})]}),(0,n.jsx)("div",{className:"space-y-3",children:0===ef.length?(0,n.jsx)(r.Zb,{children:(0,n.jsx)(r.ub,{icon:(0,n.jsx)(u.Z,{className:"w-8 h-8"}),title:"lo"===L?"ບໍ່ມີນັດໝາຍ":"No appointments",action:(0,n.jsx)(r.zx,{onClick:()=>eN(),children:O("appointments.add")})})}):ef.map(e=>(0,n.jsx)(r.Zb,{hover:!0,className:"p-0 overflow-hidden",children:(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsxs)("div",{className:"w-24 sm:w-28 p-4 flex flex-col items-center justify-center text-white ".concat("done"===e.status?"bg-gradient-to-br from-emerald-500 to-green-600":"cancelled"===e.status?"bg-gradient-to-br from-gray-400 to-gray-500":"bg-gradient-to-br from-rose-500 to-pink-500"),children:[(0,n.jsx)(f.Z,{className:"w-5 h-5 mb-1 opacity-80"}),(0,n.jsx)("span",{className:"text-xl font-bold",children:e.appointment_time.substring(0,5)}),(0,n.jsxs)("span",{className:"text-xs opacity-80",children:[e.duration," ","lo"===L?"ນາທີ":"min"]})]}),(0,n.jsx)("div",{className:"flex-1 p-4",children:(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(v.Z,{className:"w-4 h-4 text-gray-400"}),(0,n.jsx)("span",{className:"font-semibold text-gray-900",children:e.customer_name}),ek(e.status)]}),(0,n.jsx)("p",{className:"text-sm text-rose-600 font-medium",children:"lo"===L?e.service_name_lo:e.service_name}),(0,n.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[(0,n.jsxs)("span",{className:"flex items-center gap-1",children:[(0,n.jsx)(g.Z,{className:"w-3 h-3"})," ",e.customer_phone]}),(0,n.jsxs)("span",{children:["lo"===L?"ພະນັກງານ":"Staff",": ",e.staff_name]})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsxs)("div",{className:"text-right mr-2",children:[(0,n.jsx)("span",{className:"text-lg font-bold text-gray-900",children:(0,d.xG)(e.total_price)}),e.discount>0&&(0,n.jsxs)("p",{className:"text-xs text-red-500",children:["-",(0,d.xG)(e.discount)]})]}),"pending"===e.status&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:()=>G(e.id,{status:"confirmed"}),className:"p-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100",title:"lo"===L?"ຢືນຢັນ":"Confirm",children:(0,n.jsx)(b.Z,{className:"w-4 h-4"})}),(0,n.jsx)("button",{onClick:()=>eN(e),className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,n.jsx)(j.Z,{className:"w-4 h-4 text-gray-500"})}),(0,n.jsx)("button",{onClick:()=>G(e.id,{status:"cancelled"}),className:"p-2 hover:bg-red-50 rounded-lg",children:(0,n.jsx)(y.Z,{className:"w-4 h-4 text-red-500"})})]}),"confirmed"===e.status&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:()=>G(e.id,{status:"in_progress"}),className:"p-2 bg-amber-50 text-amber-600 rounded-lg hover:bg-amber-100",title:"lo"===L?"ເລີ່ມ":"Start",children:(0,n.jsx)(_,{className:"w-4 h-4"})}),(0,n.jsx)("button",{onClick:()=>eN(e),className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,n.jsx)(j.Z,{className:"w-4 h-4 text-gray-500"})}),(0,n.jsx)("button",{onClick:()=>G(e.id,{status:"cancelled"}),className:"p-2 hover:bg-red-50 rounded-lg",children:(0,n.jsx)(y.Z,{className:"w-4 h-4 text-red-500"})})]}),"in_progress"===e.status&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.zx,{size:"sm",variant:"success",icon:(0,n.jsx)(N.Z,{className:"w-4 h-4"}),onClick:()=>ey(e),children:"lo"===L?"ຮັບເງິນ":"Payment"}),(0,n.jsx)("button",{onClick:()=>G(e.id,{status:"cancelled"}),className:"p-2 hover:bg-red-50 rounded-lg",children:(0,n.jsx)(y.Z,{className:"w-4 h-4 text-red-500"})})]}),"done"===e.status&&(0,n.jsx)(r.zx,{size:"sm",variant:"secondary",icon:(0,n.jsx)(w.Z,{className:"w-4 h-4"}),onClick:()=>e_(e),children:"lo"===L?"ໃບເສັດ":"Receipt"})]})]})})]})},e.id))}),(0,n.jsx)(r.u_,{isOpen:V,onClose:ew,title:O(en?"common.edit":"appointments.add"),size:"lg",children:(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault();let s=P.find(e=>e.id===Number(ex.service_id)),t=M.find(e=>e.id===Number(ex.staff_id)),n=Number(ex.price),a=Number(ex.discount)||0,l={customer_id:Number(ex.customer_id),customer_name:ex.customer_name,customer_phone:ex.customer_phone,service_id:Number(ex.service_id),service_name:(null==s?void 0:s.name)||"",service_name_lo:(null==s?void 0:s.name_lo)||"",staff_id:Number(ex.staff_id),staff_name:(null==t?void 0:t.full_name)||"",appointment_date:ex.appointment_date,appointment_time:ex.appointment_time,duration:(null==s?void 0:s.duration)||60,price:n,discount:a,total_price:n-a,status:"pending",notes:ex.notes};en?G(en.id,l):D(l),ew()},className:"space-y-4",children:[(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[O("appointments.customer")," *"]}),(0,n.jsx)("input",{type:"text",value:ec,onChange:e=>eo(e.target.value),className:"w-full px-4 py-2.5 border rounded-lg",placeholder:"lo"===L?"ຄົ້ນຫາລູກຄ້າ...":"Search customer...",required:!0}),er&&em.length>0&&(0,n.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-60 overflow-y-auto",children:em.map(e=>(0,n.jsxs)("button",{type:"button",onClick:()=>ej(e),className:"w-full px-4 py-2 text-left hover:bg-gray-50 flex justify-between",children:[(0,n.jsx)("span",{className:"font-medium",children:e.name}),(0,n.jsx)("span",{className:"text-gray-500 text-sm",children:e.phone})]},e.id))})]}),(0,n.jsx)(r.Ph,{label:O("appointments.service"),value:ex.service_id,onChange:e=>eb(e.target.value),options:P.filter(e=>e.is_active).map(e=>({value:e.id,label:"".concat("lo"===L?e.name_lo:e.name," - ").concat((0,d.xG)(e.price))})),placeholder:"-- ".concat("lo"===L?"ເລືອກບໍລິການ":"Select Service"," --"),required:!0}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsx)(r.II,{label:"lo"===L?"ລາຄາ":"Price",type:"number",value:ex.price,onChange:e=>eu({...ex,price:e.target.value}),required:!0}),(0,n.jsx)(r.II,{label:"lo"===L?"ສ່ວນຫຼຸດ":"Discount",type:"number",value:ex.discount,onChange:e=>eu({...ex,discount:e.target.value})})]}),(0,n.jsx)(r.Ph,{label:O("appointments.staff"),value:ex.staff_id,onChange:e=>eu({...ex,staff_id:e.target.value}),options:eh.map(e=>({value:e.id,label:e.full_name})),placeholder:"-- ".concat("lo"===L?"ເລືອກພະນັກງານ":"Select Staff"," --"),required:!0}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsx)(r.II,{label:O("appointments.date"),type:"date",value:ex.appointment_date,onChange:e=>eu({...ex,appointment_date:e.target.value}),required:!0}),(0,n.jsx)(r.II,{label:O("appointments.time"),type:"time",value:ex.appointment_time,onChange:e=>eu({...ex,appointment_time:e.target.value}),required:!0})]}),(0,n.jsx)(r.II,{label:"lo"===L?"ໝາຍເຫດ":"Notes",value:ex.notes,onChange:e=>eu({...ex,notes:e.target.value})}),(0,n.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,n.jsx)(r.zx,{type:"button",variant:"secondary",className:"flex-1",onClick:ew,children:O("common.cancel")}),(0,n.jsx)(r.zx,{type:"submit",className:"flex-1",children:O("common.save")})]})]})}),(0,n.jsx)(r.u_,{isOpen:Q,onClose:()=>J(!1),title:"lo"===L?"ຮັບເງິນ":"Receive Payment",size:"md",children:es&&(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"bg-gray-50 p-4 rounded-xl",children:[(0,n.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,n.jsx)("span",{className:"text-gray-600",children:"lo"===L?"ລູກຄ້າ":"Customer"}),(0,n.jsx)("span",{className:"font-medium",children:es.customer_name})]}),(0,n.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,n.jsx)("span",{className:"text-gray-600",children:"lo"===L?"ບໍລິການ":"Service"}),(0,n.jsx)("span",{className:"font-medium",children:"lo"===L?es.service_name_lo:es.service_name})]}),(0,n.jsxs)("div",{className:"border-t pt-2 mt-2",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-gray-600",children:"lo"===L?"ລາຄາ":"Price"}),(0,n.jsx)("span",{children:(0,d.xG)(es.price)})]}),es.discount>0&&(0,n.jsxs)("div",{className:"flex justify-between text-red-600",children:[(0,n.jsx)("span",{children:"lo"===L?"ສ່ວນຫຼຸດ":"Discount"}),(0,n.jsxs)("span",{children:["-",(0,d.xG)(es.discount)]})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsxs)("span",{className:"text-gray-600",children:["lo"===L?"ອາກອນ":"Tax"," (",T.tax_rate,"%)"]}),(0,n.jsx)("span",{children:(0,d.xG)(Math.round((es.price-(es.discount||0))*T.tax_rate/100))})]}),(0,n.jsxs)("div",{className:"flex justify-between text-xl font-bold mt-2 pt-2 border-t",children:[(0,n.jsx)("span",{children:"lo"===L?"ຍອດລວມ":"Total"}),(0,n.jsx)("span",{className:"text-rose-600",children:(0,d.xG)(es.price-(es.discount||0)+Math.round((es.price-(es.discount||0))*T.tax_rate/100))})]})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"lo"===L?"ວິທີຊຳລະ":"Payment Method"}),(0,n.jsx)("div",{className:"grid grid-cols-3 gap-2",children:[{value:"cash",label:"lo"===L?"ເງິນສົດ":"Cash",icon:k.Z,color:"emerald"},{value:"transfer",label:"lo"===L?"ໂອນ":"Transfer",icon:C.Z,color:"blue"},{value:"card",label:"lo"===L?"ບັດ":"Card",icon:S.Z,color:"purple"}].map(e=>(0,n.jsxs)("button",{type:"button",onClick:()=>ei(e.value),className:"p-4 rounded-xl border-2 transition-all flex flex-col items-center gap-2 ".concat(el===e.value?"border-".concat(e.color,"-500 bg-").concat(e.color,"-50"):"border-gray-200 hover:border-gray-300"),children:[(0,n.jsx)(e.icon,{className:"w-6 h-6 ".concat(el===e.value?"text-".concat(e.color,"-600"):"text-gray-400")}),(0,n.jsx)("span",{className:"text-sm font-medium ".concat(el===e.value?"text-".concat(e.color,"-700"):"text-gray-600"),children:e.label})]},e.value))})]}),(0,n.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,n.jsx)(r.zx,{type:"button",variant:"secondary",className:"flex-1",onClick:()=>J(!1),children:"lo"===L?"ຍົກເລີກ":"Cancel"}),(0,n.jsx)(r.zx,{type:"button",variant:"success",className:"flex-1",icon:(0,n.jsx)(N.Z,{className:"w-5 h-5"}),onClick:()=>{if(!es)return;let e=es.price,t=es.discount||0,n=e-t,a=Math.round(n*T.tax_rate/100),l=n+a,i={id:Math.max(...q.map(e=>e.id),0)+1,bill_number:"RCP-".concat(new Date().getFullYear(),"-").concat(String(q.length+1).padStart(5,"0")),appointment_id:es.id,customer_id:es.customer_id,customer_name:es.customer_name,customer_phone:es.customer_phone,service_id:es.service_id,service_name:es.service_name,service_name_lo:es.service_name_lo,staff_id:es.staff_id,staff_name:es.staff_name,subtotal:e,discount_amount:t,tax_rate:T.tax_rate,tax_amount:a,grand_total:l,payment_method:el,payment_status:"paid",notes:"",created_at:new Date().toISOString().split("T")[0],created_time:new Date().toTimeString().substring(0,5)};G(es.id,{status:"done"}),R(i),A({type:"income",category_id:0,category_name:"Service",description:"".concat(es.service_name," - ").concat(es.customer_name),amount:l,payment_method:el,bill_id:i.id,created_by:(null==s?void 0:s.id)||1,created_by_name:(null==s?void 0:s.full_name)||"Admin"}),J(!1),ee(i),W(!0)},children:"lo"===L?"ຢືນຢັນການຮັບເງິນ":"Confirm Payment"})]})]})}),(0,n.jsx)(r.u_,{isOpen:K,onClose:()=>W(!1),title:"".concat("lo"===L?"ໃບຮັບເງິນ":"Receipt"),size:"md",children:$&&(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"bg-white border rounded-xl p-6 font-mono text-sm max-h-[60vh] overflow-y-auto",children:[(0,n.jsxs)("div",{className:"text-center border-b pb-4 mb-4",children:[(0,n.jsx)("h2",{className:"text-lg font-bold",children:T.shop_name}),(0,n.jsx)("p",{className:"text-gray-600",children:T.shop_name_lo}),(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:T.address}),(0,n.jsxs)("p",{className:"text-xs text-gray-500",children:["Tel: ",T.phone]})]}),(0,n.jsxs)("div",{className:"text-center mb-4",children:[(0,n.jsx)("p",{className:"text-base font-bold",children:"lo"===L?"ໃບຮັບເງິນ":"RECEIPT"}),(0,n.jsxs)("p",{className:"text-lg font-bold text-rose-600",children:["#",$.bill_number]}),(0,n.jsxs)("p",{className:"text-xs text-gray-500",children:[$.created_at," ",$.created_time||""]})]}),(0,n.jsxs)("div",{className:"border-t border-dashed pt-3 mb-3 space-y-1",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsxs)("span",{className:"text-gray-500",children:["lo"===L?"ລູກຄ້າ":"Customer",":"]}),(0,n.jsx)("span",{className:"font-medium",children:$.customer_name})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsxs)("span",{className:"text-gray-500",children:["lo"===L?"ເບີໂທ":"Phone",":"]}),(0,n.jsx)("span",{children:$.customer_phone})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsxs)("span",{className:"text-gray-500",children:["lo"===L?"ພະນັກງານ":"Staff",":"]}),(0,n.jsx)("span",{children:$.staff_name})]})]}),(0,n.jsxs)("div",{className:"border-t border-b border-dashed py-3 mb-3",children:[(0,n.jsx)("p",{className:"font-medium",children:"lo"===L?$.service_name_lo:$.service_name}),(0,n.jsx)("p",{className:"text-right font-medium",children:(0,d.xG)($.subtotal)})]}),(0,n.jsxs)("div",{className:"space-y-1 mb-3",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-gray-500",children:"lo"===L?"ລາຄາ":"Subtotal"}),(0,n.jsx)("span",{children:(0,d.xG)($.subtotal)})]}),$.discount_amount>0&&(0,n.jsxs)("div",{className:"flex justify-between text-red-600",children:[(0,n.jsx)("span",{children:"lo"===L?"ສ່ວນຫຼຸດ":"Discount"}),(0,n.jsxs)("span",{children:["-",(0,d.xG)($.discount_amount)]})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsxs)("span",{className:"text-gray-500",children:["lo"===L?"ອາກອນ":"VAT"," (",$.tax_rate,"%)"]}),(0,n.jsx)("span",{children:(0,d.xG)($.tax_amount)})]})]}),(0,n.jsx)("div",{className:"bg-gray-100 -mx-6 px-6 py-3 mb-3",children:(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)("span",{className:"text-lg font-bold",children:"lo"===L?"ຍອດລວມ":"GRAND TOTAL"}),(0,n.jsx)("span",{className:"text-2xl font-bold text-rose-600",children:(0,d.xG)($.grand_total)})]})}),(0,n.jsxs)("div",{className:"space-y-1 mb-4",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-gray-500",children:"lo"===L?"ຊຳລະດ້ວຍ":"Paid by"}),(0,n.jsx)("span",{className:"font-medium",children:eC($.payment_method)})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-gray-500",children:"lo"===L?"ສະຖານະ":"Status"}),(0,n.jsxs)("span",{className:"text-emerald-600 font-bold",children:["✓ ","lo"===L?"ຊຳລະແລ້ວ":"PAID"]})]})]}),(0,n.jsxs)("div",{className:"text-center border-t pt-4 text-xs text-gray-500",children:[(0,n.jsx)("p",{className:"font-medium",children:"lo"===L?"ຂອບໃຈທີ່ໃຊ້ບໍລິການ":"Thank you for your visit!"}),(0,n.jsx)("p",{className:"mt-2",children:"lo"===L?"ກະລຸນາເກັບໄວ້ເປັນຫຼັກຖານ":"Please keep for your records"})]})]}),(0,n.jsxs)("div",{className:"flex gap-3 mt-4",children:[(0,n.jsx)(r.zx,{variant:"secondary",className:"flex-1",onClick:()=>W(!1),children:"lo"===L?"ປິດ":"Close"}),(0,n.jsx)(r.zx,{className:"flex-1",icon:(0,n.jsx)(Z.Z,{className:"w-5 h-5"}),onClick:()=>{let e=window.open("","_blank");e&&$&&(e.document.write('\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8">\n  <title>Receipt #'.concat($.bill_number,'</title>\n  <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    body { \n      font-family: \'Courier New\', monospace; \n      font-size: 12px; \n      width: 80mm; \n      margin: 0 auto; \n      padding: 8mm 4mm;\n      line-height: 1.4;\n    }\n    .center { text-align: center; }\n    .right { text-align: right; }\n    .bold { font-weight: bold; }\n    .shop-name { font-size: 16px; font-weight: bold; margin-bottom: 2px; }\n    .shop-info { font-size: 10px; color: #555; }\n    .divider { border-top: 1px dashed #000; margin: 8px 0; }\n    .double-divider { border-top: 2px solid #000; margin: 8px 0; }\n    .bill-no { font-size: 14px; font-weight: bold; margin: 8px 0; letter-spacing: 1px; }\n    .row { display: flex; justify-content: space-between; margin: 3px 0; }\n    .label { color: #555; }\n    .total-section { background: #f5f5f5; padding: 8px; margin: 8px -4mm; }\n    .grand-total { font-size: 18px; font-weight: bold; }\n    .footer { font-size: 10px; color: #555; margin-top: 12px; }\n    .qr-placeholder { width: 60px; height: 60px; border: 1px dashed #999; margin: 8px auto; display: flex; align-items: center; justify-content: center; font-size: 8px; color: #999; }\n  </style>\n</head>\n<body>\n  <div class="center">\n    <div class="shop-name">').concat(T.shop_name,'</div>\n    <div class="shop-name">').concat(T.shop_name_lo,'</div>\n    <div class="shop-info">').concat(T.address,'</div>\n    <div class="shop-info">Tel: ').concat(T.phone,'</div>\n  </div>\n  \n  <div class="divider"></div>\n  \n  <div class="center">\n    <div style="font-size: 14px; font-weight: bold;">ໃບຮັບເງິນ / RECEIPT</div>\n    <div class="bill-no">#').concat($.bill_number,'</div>\n    <div style="font-size: 10px; color: #555;">').concat($.created_at," ").concat($.created_time||"",'</div>\n  </div>\n  \n  <div class="divider"></div>\n  \n  <div class="row"><span class="label">').concat("lo"===L?"ລູກຄ້າ":"Customer",':</span><span class="bold">').concat($.customer_name,'</span></div>\n  <div class="row"><span class="label">').concat("lo"===L?"ເບີໂທ":"Phone",":</span><span>").concat($.customer_phone,'</span></div>\n  <div class="row"><span class="label">').concat("lo"===L?"ພະນັກງານ":"Staff",":</span><span>").concat($.staff_name,'</span></div>\n  \n  <div class="double-divider"></div>\n  \n  <div style="margin-bottom: 4px;">\n    <div class="bold">').concat("lo"===L?$.service_name_lo:$.service_name,'</div>\n    <div class="right" style="margin-top: -14px;">').concat((0,d.xG)($.subtotal),'</div>\n  </div>\n  \n  <div class="divider"></div>\n  \n  <div class="row"><span class="label">').concat("lo"===L?"ລາຄາ":"Subtotal","</span><span>").concat((0,d.xG)($.subtotal),"</span></div>\n  ").concat($.discount_amount>0?'<div class="row" style="color: #e11d48;"><span>'.concat("lo"===L?"ສ່ວນຫຼຸດ":"Discount","</span><span>-").concat((0,d.xG)($.discount_amount),"</span></div>"):"",'\n  <div class="row"><span class="label">').concat("lo"===L?"ອາກອນ":"VAT"," (").concat($.tax_rate,"%)</span><span>").concat((0,d.xG)($.tax_amount),'</span></div>\n  \n  <div class="total-section">\n    <div class="row grand-total">\n      <span>').concat("lo"===L?"ຍອດລວມ":"GRAND TOTAL","</span>\n      <span>").concat((0,d.xG)($.grand_total),'</span>\n    </div>\n  </div>\n  \n  <div class="row"><span class="label">').concat("lo"===L?"ຊຳລະດ້ວຍ":"Paid by",'</span><span class="bold">').concat(eC($.payment_method),'</span></div>\n  <div class="row"><span class="label">').concat("lo"===L?"ສະຖານະ":"Status",'</span><span style="color: #059669;" class="bold">✓ ').concat("lo"===L?"ຊຳລະແລ້ວ":"PAID",'</span></div>\n  \n  <div class="divider"></div>\n  \n  <div class="center footer">\n    <p>').concat("lo"===L?"ຂອບໃຈທີ່ໃຊ້ບໍລິການ":"Thank you for your visit!","</p>\n    <p>ເລກປະຈຳຕົວຜູ້ເສຍອາກອນ: ").concat(T.tax_id||"XXXXXXXXXX",'</p>\n    <div class="qr-placeholder">QR Code</div>\n    <p style="margin-top: 8px;">--- ').concat("lo"===L?"ກະລຸນາເກັບໄວ້ເປັນຫຼັກຖານ":"Please keep for your records"," ---</p>\n  </div>\n</body>\n</html>\n      ")),e.document.close(),setTimeout(()=>{e.print()},250))},children:"lo"===L?"ພິມໃບເສັດ":"Print Receipt"})]})]})})]})})}}},function(e){e.O(0,[549,576,36,619,971,69,744],function(){return e(e.s=2311)}),_N_E=e.O()}]);