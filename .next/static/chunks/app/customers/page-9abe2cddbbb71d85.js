(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[374],{7867:function(e,s,t){Promise.resolve().then(t.bind(t,7277))},8219:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,t(7461).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},684:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,t(7461).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},5421:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,t(7461).Z)("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]])},5904:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,t(7461).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},94:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,t(7461).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},489:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,t(7461).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},7277:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return f}});var l=t(3827),a=t(4090),n=t(7907),r=t(3036),i=t(9003),c=t(1965),o=t(5030),d=t(2169),m=t(94),x=t(4059);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,t(7461).Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);var h=t(8219),p=t(5421),g=t(489),j=t(5904),v=t(684);function f(){var e;let s=(0,n.useRouter)(),{isAuthenticated:t}=(0,r.t)(),{customers:f,appointments:N,addCustomer:y,updateCustomer:b,deleteCustomer:k}=(0,r.a)(),{locale:w,t:C}=(0,i.useI18n)(),[_,Z]=(0,a.useState)(""),[M,S]=(0,a.useState)(!1),[I,P]=(0,a.useState)(!1),[z,A]=(0,a.useState)(null),[G,L]=(0,a.useState)(null),[q,V]=(0,a.useState)({name:"",phone:"",email:"",gender:"female",notes:""});if((0,a.useEffect)(()=>{t||s.push("/login")},[t,s]),!t)return null;let R=(0,a.useMemo)(()=>f.filter(e=>{var s;return e.name.toLowerCase().includes(_.toLowerCase())||e.phone.includes(_)||(null===(s=e.email)||void 0===s?void 0:s.toLowerCase().includes(_.toLowerCase()))}),[f,_]),E=(0,a.useMemo)(()=>({total:f.length,totalSpent:f.reduce((e,s)=>e+s.total_spent,0),avgSpent:f.length>0?Math.round(f.reduce((e,s)=>e+s.total_spent,0)/f.length):0,vip:f.filter(e=>e.total_visits>=10).length}),[f]),H=e=>{e?(L(e),V({name:e.name,phone:e.phone,email:e.email||"",gender:e.gender,notes:e.notes||""})):(L(null),V({name:"",phone:"",email:"",gender:"female",notes:""})),S(!0)},O=()=>{S(!1),L(null),V({name:"",phone:"",email:"",gender:"female",notes:""})},T=e=>{A(e),P(!0)};return(0,l.jsx)(c.Z,{children:(0,l.jsxs)("div",{className:"space-y-6 animate-fadeIn",children:[(0,l.jsx)(o.mr,{title:C("customers.title"),subtitle:"lo"===w?"ຈັດການຂໍ້ມູນລູກຄ້າ":"Manage customer information",action:(0,l.jsx)(o.zx,{icon:(0,l.jsx)(m.Z,{className:"w-5 h-5"}),onClick:()=>H(),children:C("customers.add")})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,l.jsx)(o.Rm,{title:"lo"===w?"ລູກຄ້າທັງໝົດ":"Total Customers",value:E.total,icon:(0,l.jsx)(x.Z,{className:"w-6 h-6"}),color:"blue"}),(0,l.jsx)(o.Rm,{title:"lo"===w?"ລູກຄ້າ VIP":"VIP Customers",value:E.vip,icon:(0,l.jsx)(u,{className:"w-6 h-6"}),color:"amber"}),(0,l.jsx)(o.Rm,{title:"lo"===w?"ຍອດໃຊ້ຈ່າຍລວມ":"Total Spent",value:(0,d.xG)(E.totalSpent),icon:(0,l.jsx)(h.Z,{className:"w-6 h-6"}),color:"emerald"}),(0,l.jsx)(o.Rm,{title:"lo"===w?"ສະເລ່ຍຕໍ່ຄົນ":"Average per Customer",value:(0,d.xG)(E.avgSpent),icon:(0,l.jsx)(h.Z,{className:"w-6 h-6"}),color:"purple"})]}),(0,l.jsx)(o.Mj,{value:_,onChange:Z,placeholder:C("common.search")}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:0===R.length?(0,l.jsx)("div",{className:"col-span-full",children:(0,l.jsx)(o.Zb,{children:(0,l.jsx)(o.ub,{icon:(0,l.jsx)(x.Z,{className:"w-8 h-8"}),title:"lo"===w?"ບໍ່ພົບລູກຄ້າ":"No customers found",action:(0,l.jsx)(o.zx,{onClick:()=>H(),children:C("customers.add")})})})}):R.map(e=>(0,l.jsxs)(o.Zb,{hover:!0,className:"cursor-pointer",onClick:()=>T(e),children:[(0,l.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-rose-400 to-pink-500 flex items-center justify-center text-white font-bold text-lg",children:e.name.charAt(0)}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-semibold text-gray-900",children:e.name}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[e.total_visits>=10&&(0,l.jsxs)(o.Ct,{variant:"warning",children:[(0,l.jsx)(u,{className:"w-3 h-3 mr-1"}),"VIP"]}),(0,l.jsxs)("span",{className:"text-xs text-gray-500",children:[e.total_visits," ","lo"===w?"ຄັ້ງ":"visits"]})]})]})]}),(0,l.jsxs)("div",{className:"flex gap-1",onClick:e=>e.stopPropagation(),children:[(0,l.jsx)("button",{onClick:()=>H(e),className:"p-1.5 hover:bg-gray-100 rounded-lg",children:(0,l.jsx)(p.Z,{className:"w-4 h-4 text-gray-500"})}),(0,l.jsx)("button",{onClick:()=>k(e.id),className:"p-1.5 hover:bg-red-50 rounded-lg",children:(0,l.jsx)(g.Z,{className:"w-4 h-4 text-red-500"})})]})]}),(0,l.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,l.jsx)(j.Z,{className:"w-4 h-4 text-gray-400"}),e.phone]}),e.email&&(0,l.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,l.jsx)(v.Z,{className:"w-4 h-4 text-gray-400"}),e.email]})]}),(0,l.jsxs)("div",{className:"mt-4 pt-4 border-t flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-sm text-gray-500",children:"lo"===w?"ຍອດໃຊ້ຈ່າຍ":"Total Spent"}),(0,l.jsx)("span",{className:"font-bold text-rose-600",children:(0,d.xG)(e.total_spent)})]})]},e.id))}),(0,l.jsx)(o.u_,{isOpen:M,onClose:O,title:C(G?"common.edit":"customers.add"),children:(0,l.jsxs)("form",{onSubmit:e=>{e.preventDefault(),G?b(G.id,q):y(q),O()},className:"space-y-4",children:[(0,l.jsx)(o.II,{label:C("customers.name"),value:q.name,onChange:e=>V({...q,name:e.target.value}),placeholder:"lo"===w?"ຊື່ລູກຄ້າ":"Customer name",required:!0}),(0,l.jsx)(o.II,{label:C("customers.phone"),type:"tel",value:q.phone,onChange:e=>V({...q,phone:e.target.value}),placeholder:"020 xxxx xxxx",required:!0}),(0,l.jsx)(o.II,{label:C("customers.email"),type:"email",value:q.email,onChange:e=>V({...q,email:e.target.value}),placeholder:"email@example.com"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"lo"===w?"ເພດ":"Gender"}),(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,l.jsx)("input",{type:"radio",name:"gender",value:"female",checked:"female"===q.gender,onChange:e=>V({...q,gender:e.target.value}),className:"text-rose-500"}),(0,l.jsx)("span",{children:"lo"===w?"ຍິງ":"Female"})]}),(0,l.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,l.jsx)("input",{type:"radio",name:"gender",value:"male",checked:"male"===q.gender,onChange:e=>V({...q,gender:e.target.value}),className:"text-rose-500"}),(0,l.jsx)("span",{children:"lo"===w?"ຊາຍ":"Male"})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"lo"===w?"ໝາຍເຫດ":"Notes"}),(0,l.jsx)("textarea",{value:q.notes,onChange:e=>V({...q,notes:e.target.value}),className:"w-full px-4 py-2.5 border rounded-lg resize-none",rows:3})]}),(0,l.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,l.jsx)(o.zx,{type:"button",variant:"secondary",className:"flex-1",onClick:O,children:C("common.cancel")}),(0,l.jsx)(o.zx,{type:"submit",className:"flex-1",children:C("common.save")})]})]})}),(0,l.jsx)(o.u_,{isOpen:I,onClose:()=>P(!1),title:(null==z?void 0:z.name)||"",size:"lg",children:z&&(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-rose-400 to-pink-500 flex items-center justify-center text-white font-bold text-2xl",children:z.name.charAt(0)}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:z.name}),(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,l.jsx)(j.Z,{className:"w-4 h-4"})," ",z.phone]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{className:"bg-rose-50 rounded-xl p-4 text-center",children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-rose-600",children:z.total_visits}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"lo"===w?"ຄັ້ງ":"Visits"})]}),(0,l.jsxs)("div",{className:"bg-emerald-50 rounded-xl p-4 text-center",children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-emerald-600",children:(0,d.xG)(z.total_spent)}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"lo"===w?"ໃຊ້ຈ່າຍ":"Spent"})]}),(0,l.jsxs)("div",{className:"bg-blue-50 rounded-xl p-4 text-center",children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:(0,d.xG)(z.total_visits>0?Math.round(z.total_spent/z.total_visits):0)}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"lo"===w?"ສະເລ່ຍ":"Avg"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-semibold text-gray-900 mb-3",children:"lo"===w?"ປະຫວັດນັດໝາຍ":"Appointment History"}),(0,l.jsx)("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:(e=z.id,N.filter(s=>s.customer_id===e).sort((e,s)=>s.appointment_date.localeCompare(e.appointment_date))).slice(0,10).map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium text-sm",children:"lo"===w?e.service_name_lo:e.service_name}),(0,l.jsxs)("p",{className:"text-xs text-gray-500",children:[e.appointment_date," • ",e.appointment_time.substring(0,5)]})]}),(0,l.jsx)(o.Ct,{variant:"completed"===e.status?"success":"cancelled"===e.status?"danger":"info",children:(0,d.xG)(e.total_price)})]},e.id))})]})]})})]})})}}},function(e){e.O(0,[549,576,36,619,971,69,744],function(){return e(e.s=7867)}),_N_E=e.O()}]);