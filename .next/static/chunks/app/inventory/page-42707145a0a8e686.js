(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[268],{9922:function(e,l,t){Promise.resolve().then(t.bind(t,3283))},5160:function(e,l,t){"use strict";t.d(l,{Z:function(){return a}});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(7461).Z)("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]])},7336:function(e,l,t){"use strict";t.d(l,{Z:function(){return a}});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(7461).Z)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},8219:function(e,l,t){"use strict";t.d(l,{Z:function(){return a}});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(7461).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},5421:function(e,l,t){"use strict";t.d(l,{Z:function(){return a}});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(7461).Z)("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]])},94:function(e,l,t){"use strict";t.d(l,{Z:function(){return a}});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(7461).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},489:function(e,l,t){"use strict";t.d(l,{Z:function(){return a}});/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(7461).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},3283:function(e,l,t){"use strict";t.r(l),t.d(l,{default:function(){return f}});var a=t(3827),r=t(4090),n=t(7907),i=t(3036),s=t(9003),o=t(1965),c=t(5030),u=t(2169),d=t(94),m=t(4697),x=t(1524),g=t(8219),p=t(5160),h=t(5421),y=t(489);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let v=(0,t(7461).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var j=t(2235),b=t(7336);function f(){let e=(0,n.useRouter)(),{isAuthenticated:l}=(0,i.t)(),{inventory:t,inventoryCategories:f,addInventoryItem:_,updateInventoryItem:N,deleteInventoryItem:k,updateInventoryImage:w}=(0,i.a)(),{locale:q,t:S}=(0,s.useI18n)(),[C,I]=(0,r.useState)(""),[Z,P]=(0,r.useState)(""),[M,L]=(0,r.useState)(""),[G,z]=(0,r.useState)(!1),[R,B]=(0,r.useState)(null),[E,H]=(0,r.useState)(null),[U,V]=(0,r.useState)(!1),A=(0,r.useRef)(null),[F,O]=(0,r.useState)({name:"",name_lo:"",category_id:"",sku:"",quantity:"",min_quantity:"",cost_price:"",sell_price:"",unit:"piece",supplier:"",location:"",image_url:""});if((0,r.useEffect)(()=>{l||e.push("/login")},[l,e]),!l)return null;let D=(0,r.useMemo)(()=>t.filter(e=>{let l=e.name.toLowerCase().includes(C.toLowerCase())||e.sku&&e.sku.toLowerCase().includes(C.toLowerCase()),t=!Z||e.category_id===Number(Z),a=!M||"low"===M&&e.quantity<=e.min_quantity||"ok"===M&&e.quantity>e.min_quantity;return l&&t&&a}),[t,C,Z,M]),J=(0,r.useMemo)(()=>{let e=t.filter(e=>e.quantity<=e.min_quantity),l=t.reduce((e,l)=>e+l.quantity*l.cost_price,0),a=t.reduce((e,l)=>e+l.quantity*l.sell_price,0);return{total:t.length,lowStock:e.length,totalValue:l,potentialProfit:a-l}},[t]),K=[{value:"piece",label:"lo"===q?"ອັນ":"Piece"},{value:"bottle",label:"lo"===q?"ຂວດ":"Bottle"},{value:"box",label:"lo"===q?"ກ່ອງ":"Box"},{value:"pack",label:"lo"===q?"ແພັກ":"Pack"},{value:"set",label:"lo"===q?"ຊຸດ":"Set"},{value:"jar",label:"lo"===q?"ກະປ໋ອງ":"Jar"}],Q=()=>{H(null),O(e=>({...e,image_url:""})),A.current&&(A.current.value="")},T=e=>{e?(B(e),H(e.image_url||null),O({name:e.name,name_lo:e.name_lo||"",category_id:String(e.category_id||""),sku:e.sku||"",quantity:String(e.quantity),min_quantity:String(e.min_quantity),cost_price:String(e.cost_price),sell_price:String(e.sell_price),unit:e.unit||"piece",supplier:e.supplier||"",location:e.location||"",image_url:e.image_url||""})):(B(null),H(null),O({name:"",name_lo:"",category_id:"",sku:"",quantity:"0",min_quantity:"5",cost_price:"",sell_price:"",unit:"piece",supplier:"",location:"",image_url:""})),z(!0)},W=()=>{z(!1),B(null),H(null),A.current&&(A.current.value="")},X=e=>0===e.quantity?{label:"lo"===q?"ໝົດສະຕັອກ":"Out of Stock",color:"bg-red-100 text-red-700"}:e.quantity<=e.min_quantity?{label:"lo"===q?"ໃກ້ໝົດ":"Low Stock",color:"bg-amber-100 text-amber-700"}:{label:"lo"===q?"ພຽງພໍ":"In Stock",color:"bg-emerald-100 text-emerald-700"},Y=e=>e.image_url&&e.image_url.startsWith("data:")||e.image_url?e.image_url:(0,u.G)(e.name,e.category);return(0,a.jsx)(o.Z,{children:(0,a.jsxs)("div",{className:"space-y-6 animate-fadeIn",children:[(0,a.jsx)(c.mr,{title:S("inventory.title"),subtitle:"lo"===q?"ຈັດການສິນຄ້າຄົງຄັງ":"Manage inventory items",action:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(c.zx,{variant:"secondary",onClick:()=>e.push("/stock"),children:"lo"===q?"ຕັດສະຕັອກ":"Adjust Stock"}),(0,a.jsx)(c.zx,{icon:(0,a.jsx)(d.Z,{className:"w-5 h-5"}),onClick:()=>T(),children:S("inventory.add")})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)(c.Rm,{title:"lo"===q?"ສິນຄ້າທັງໝົດ":"Total Items",value:(0,u.uf)(J.total),icon:(0,a.jsx)(m.Z,{className:"w-6 h-6"}),color:"blue"}),(0,a.jsx)(c.Rm,{title:"lo"===q?"ສິນຄ້າໃກ້ໝົດ":"Low Stock",value:(0,u.uf)(J.lowStock),icon:(0,a.jsx)(x.Z,{className:"w-6 h-6"}),color:J.lowStock>0?"amber":"emerald"}),(0,a.jsx)(c.Rm,{title:"lo"===q?"ມູນຄ່າສະຕັອກ":"Stock Value",value:(0,u.xG)(J.totalValue),icon:(0,a.jsx)(g.Z,{className:"w-6 h-6"}),color:"purple"}),(0,a.jsx)(c.Rm,{title:"lo"===q?"ກຳໄລທີ່ຄາດ":"Potential Profit",value:(0,u.xG)(J.potentialProfit),icon:(0,a.jsx)(p.Z,{className:"w-6 h-6"}),color:"emerald"})]}),J.lowStock>0&&(0,a.jsx)(c.bZ,{variant:"warning",title:"lo"===q?"ສິນຄ້າໃກ້ໝົດ!":"Low Stock Alert!",children:"lo"===q?"ມີ ".concat(J.lowStock," ລາຍການທີ່ຕ້ອງສັ່ງເພີ່ມ"):"".concat(J.lowStock," items need restocking")}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(c.Mj,{value:C,onChange:I,placeholder:S("common.search")})}),(0,a.jsxs)("select",{value:Z,onChange:e=>P(e.target.value),className:"px-4 py-2.5 border rounded-lg bg-white",children:[(0,a.jsxs)("option",{value:"",children:[S("common.all")," ","lo"===q?"ໝວດໝູ່":"Categories"]}),f.map(e=>(0,a.jsx)("option",{value:e.id,children:"lo"===q?e.name_lo:e.name},e.id))]}),(0,a.jsxs)("select",{value:M,onChange:e=>L(e.target.value),className:"px-4 py-2.5 border rounded-lg bg-white",children:[(0,a.jsxs)("option",{value:"",children:[S("common.all")," ","lo"===q?"ສະຖານະ":"Status"]}),(0,a.jsx)("option",{value:"low",children:"lo"===q?"ໃກ້ໝົດ":"Low Stock"}),(0,a.jsx)("option",{value:"ok",children:"lo"===q?"ພຽງພໍ":"In Stock"})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:0===D.length?(0,a.jsx)("div",{className:"col-span-full",children:(0,a.jsx)(c.Zb,{className:"py-12 text-center text-gray-500",children:"lo"===q?"ບໍ່ພົບຂໍ້ມູນ":"No items found"})}):D.map(e=>{var l;let t=X(e);return(0,a.jsxs)(c.Zb,{hover:!0,className:"p-0 overflow-hidden",children:[(0,a.jsxs)("div",{className:"relative aspect-square bg-gray-100",children:[(0,a.jsx)("img",{src:Y(e),alt:e.name,className:"w-full h-full object-cover",onError:l=>{l.target.src=(0,u.G)(e.name,e.category)}}),(0,a.jsx)("span",{className:"absolute top-2 right-2 px-2 py-1 rounded-full text-xs font-medium ".concat(t.color),children:t.label})]}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 truncate",children:"lo"===q?e.name_lo:e.name}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 font-mono",children:["SKU: ",e.sku]}),(0,a.jsx)("div",{className:"flex items-center gap-2 mt-2",children:(0,a.jsx)("span",{className:"text-xs px-2 py-1 bg-gray-100 rounded-full text-gray-600",children:e.category})}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-3 pt-3 border-t",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-lg font-bold text-rose-600",children:(0,u.xG)(e.sell_price)}),(0,a.jsxs)("p",{className:"text-sm ".concat(e.quantity<=e.min_quantity?"text-red-600 font-medium":"text-gray-500"),children:[(0,u.uf)(e.quantity)," ",(null===(l=K.find(l=>l.value===e.unit))||void 0===l?void 0:l.label)||e.unit]})]}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)("button",{onClick:()=>T(e),className:"p-2 rounded-lg hover:bg-gray-100",children:(0,a.jsx)(h.Z,{className:"w-4 h-4 text-gray-500"})}),(0,a.jsx)("button",{onClick:()=>k(e.id),className:"p-2 rounded-lg hover:bg-red-50",children:(0,a.jsx)(y.Z,{className:"w-4 h-4 text-red-500"})})]})]})]})]},e.id)})}),(0,a.jsx)(c.u_,{isOpen:G,onClose:W,title:S(R?"common.edit":"inventory.add"),size:"lg",children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();let l=f.find(e=>e.id===Number(F.category_id)),t={name:F.name,name_lo:F.name_lo,category_id:Number(F.category_id),category:(null==l?void 0:l.name)||"",sku:F.sku,quantity:Number(F.quantity),min_quantity:Number(F.min_quantity),cost_price:Number(F.cost_price),sell_price:Number(F.sell_price),unit:F.unit,supplier:F.supplier,location:F.location,image_url:F.image_url||null};R?N(R.id,t):_(t),W()},className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"lo"===q?"ຮູບພາບສິນຄ້າ":"Product Image"}),(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"relative w-32 h-32 rounded-xl bg-gray-100 flex items-center justify-center overflow-hidden border-2 border-dashed border-gray-300 hover:border-rose-400 transition-colors cursor-pointer",onClick:()=>{var e;return null===(e=A.current)||void 0===e?void 0:e.click()},children:U?(0,a.jsx)("div",{className:"animate-pulse text-gray-400",children:(0,a.jsx)(v,{className:"w-8 h-8 animate-bounce"})}):E?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("img",{src:E,alt:"Preview",className:"w-full h-full object-cover"}),(0,a.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),Q()},className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full hover:bg-red-600",children:(0,a.jsx)(j.Z,{className:"w-4 h-4"})})]}):(0,a.jsxs)("div",{className:"text-center p-2",children:[(0,a.jsx)(b.Z,{className:"w-8 h-8 text-gray-400 mx-auto"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"lo"===q?"ຄລິກເພື່ອອັບໂຫຼດ":"Click to upload"})]})}),(0,a.jsx)("input",{ref:A,type:"file",accept:"image/*",onChange:e=>{var l;let t=null===(l=e.target.files)||void 0===l?void 0:l[0];if(!t)return;if(!t.type.startsWith("image/")){alert("lo"===q?"ກະລຸນາເລືອກໄຟລ໌ຮູບພາບ":"Please select an image file");return}if(t.size>2097152){alert("lo"===q?"ຮູບພາບຕ້ອງມີຂະໜາດບໍ່ເກີນ 2MB":"Image must be less than 2MB");return}V(!0);let a=new FileReader;a.onload=e=>{var l;let t=null===(l=e.target)||void 0===l?void 0:l.result;H(t),O(e=>({...e,image_url:t})),V(!1)},a.onerror=()=>{alert("lo"===q?"ເກີດຂໍ້ຜິດພາດ":"Error reading file"),V(!1)},a.readAsDataURL(t)},className:"hidden"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"lo"===q?"ອັບໂຫຼດຮູບສິນຄ້າ (PNG, JPG, GIF)":"Upload product image (PNG, JPG, GIF)"}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"lo"===q?"ຂະໜາດສູງສຸດ 2MB":"Max size 2MB"}),!E&&(0,a.jsx)(c.zx,{type:"button",variant:"secondary",size:"sm",className:"mt-2",icon:(0,a.jsx)(v,{className:"w-4 h-4"}),onClick:()=>{var e;return null===(e=A.current)||void 0===e?void 0:e.click()},children:"lo"===q?"ເລືອກຮູບ":"Choose Image"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(c.II,{label:"".concat(S("inventory.name")," (EN)"),value:F.name,onChange:e=>O({...F,name:e.target.value}),required:!0}),(0,a.jsx)(c.II,{label:"".concat(S("inventory.name")," (ລາວ)"),value:F.name_lo,onChange:e=>O({...F,name_lo:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(c.Ph,{label:"lo"===q?"ໝວດໝູ່":"Category",value:F.category_id,onChange:e=>O({...F,category_id:e.target.value}),options:f.map(e=>({value:e.id,label:"lo"===q?e.name_lo:e.name})),placeholder:"--",required:!0}),(0,a.jsx)(c.II,{label:"SKU",value:F.sku,onChange:e=>O({...F,sku:e.target.value}),placeholder:"HAIR-001",required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsx)(c.II,{label:"lo"===q?"ຈຳນວນ":"Quantity",type:"number",value:F.quantity,onChange:e=>O({...F,quantity:e.target.value}),required:!0}),(0,a.jsx)(c.Ph,{label:"lo"===q?"ຫົວໜ່ວຍ":"Unit",value:F.unit,onChange:e=>O({...F,unit:e.target.value}),options:K}),(0,a.jsx)(c.II,{label:"lo"===q?"ຈຳນວນຕ່ຳສຸດ":"Min Qty",type:"number",value:F.min_quantity,onChange:e=>O({...F,min_quantity:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(c.II,{label:"lo"===q?"ລາຄາຕົ້ນທຶນ":"Cost Price",type:"number",value:F.cost_price,onChange:e=>O({...F,cost_price:e.target.value}),required:!0}),(0,a.jsx)(c.II,{label:"lo"===q?"ລາຄາຂາຍ":"Sell Price",type:"number",value:F.sell_price,onChange:e=>O({...F,sell_price:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(c.II,{label:"lo"===q?"ຜູ້ສະໜອງ":"Supplier",value:F.supplier,onChange:e=>O({...F,supplier:e.target.value}),placeholder:"lo"===q?"ຊື່ຜູ້ສະໜອງ...":"Supplier name..."}),(0,a.jsx)(c.II,{label:"lo"===q?"ສະຖານທີ່ເກັບ":"Location",value:F.location,onChange:e=>O({...F,location:e.target.value}),placeholder:"lo"===q?"ຕຳແໜ່ງເກັບ...":"Storage location..."})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,a.jsx)(c.zx,{type:"button",variant:"secondary",className:"flex-1",onClick:W,children:S("common.cancel")}),(0,a.jsx)(c.zx,{type:"submit",className:"flex-1",children:S("common.save")})]})]})})]})})}}},function(e){e.O(0,[549,576,36,619,971,69,744],function(){return e(e.s=9922)}),_N_E=e.O()}]);