(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,21135,e=>{"use strict";let t=(0,e.i(35320).default)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);e.s(["Phone",()=>t],21135)},95508,e=>{"use strict";let t=(0,e.i(35320).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],95508)},34353,e=>{"use strict";let t=(0,e.i(35320).default)("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);e.s(["Edit2",()=>t],34353)},27823,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"warnOnce",{enumerable:!0,get:function(){return a}});let a=e=>{}},35320,e=>{"use strict";var t=e.i(29130),s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let a=(e,a)=>{let l=(0,t.forwardRef)(({color:l="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:r,className:o="",children:d,...c},m)=>(0,t.createElement)("svg",{ref:m,...s,width:n,height:n,stroke:l,strokeWidth:r?24*Number(i)/Number(n):i,className:["lucide",`lucide-${e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim()}`,o].join(" "),...c},[...a.map(([e,s])=>(0,t.createElement)(e,s)),...Array.isArray(d)?d:[d]]));return l.displayName=`${e}`,l};e.s(["default",()=>a],35320)},6180,e=>{"use strict";let t=(0,e.i(35320).default)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);e.s(["Users",()=>t],6180)},66826,53207,e=>{"use strict";var t=e.i(35320);let s=(0,t.default)("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);e.s(["Sparkles",()=>s],66826);let a=(0,t.default)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>a],53207)},14936,e=>{"use strict";let t=(0,e.i(35320).default)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);e.s(["DollarSign",()=>t],14936)},1753,e=>{"use strict";let t=(0,e.i(35320).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>t],1753)},14034,e=>{"use strict";let t=(0,e.i(35320).default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],14034)},65268,e=>{"use strict";let t=(0,e.i(35320).default)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);e.s(["CreditCard",()=>t],65268)},77056,87917,e=>{"use strict";var t=e.i(35320);let s=(0,t.default)("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);e.s(["Banknote",()=>s],77056);let a=(0,t.default)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);e.s(["Building",()=>a],87917)},80798,e=>{"use strict";let t=(0,e.i(35320).default)("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);e.s(["Printer",()=>t],80798)},14531,e=>{"use strict";var t=e.i(46623),s=e.i(29130),a=e.i(87577),l=e.i(89896),n=e.i(93841),i=e.i(1266),r=e.i(6261),o=e.i(28205),d=e.i(95508),c=e.i(1753),m=e.i(21135),p=e.i(53207),u=e.i(81422),x=e.i(35320);let h=(0,x.default)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),f=(0,x.default)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var g=e.i(34353),v=e.i(14034),y=e.i(1547);let b=(0,x.default)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);var j=e.i(6580),_=e.i(80798),N=e.i(14936),w=e.i(65268),C=e.i(77056),k=e.i(87917);function S(){let e=(0,a.useRouter)(),{user:x,isAuthenticated:S}=(0,l.useAuthStore)(),{appointments:$,customers:M,services:P,users:T,settings:D,addAppointment:z,updateAppointment:B,searchCustomers:A,bills:L,addBill:R,addTransaction:I}=(0,l.useDataStore)(),{locale:q,t:O}=(0,n.useI18n)(),[E,X]=(0,s.useState)(""),[U,H]=(0,s.useState)(""),[F,Z]=(0,s.useState)(new Date().toISOString().split("T")[0]),[G,K]=(0,s.useState)(!1),[V,W]=(0,s.useState)(!1),[Y,Q]=(0,s.useState)(!1),[J,ee]=(0,s.useState)(null),[et,es]=(0,s.useState)(null),[ea,el]=(0,s.useState)(null),[en,ei]=(0,s.useState)("cash"),[er,eo]=(0,s.useState)(""),[ed,ec]=(0,s.useState)(!1),[em,ep]=(0,s.useState)([]),[eu,ex]=(0,s.useState)({customer_id:"",customer_name:"",customer_phone:"",service_id:"",price:"",discount:"0",staff_id:"",appointment_date:"",appointment_time:"09:00",notes:""});if((0,s.useEffect)(()=>{S||e.push("/login")},[S,e]),!S)return null;let eh=T.filter(e=>"staff"===e.role&&e.is_active);(0,s.useEffect)(()=>{er.length>=2?(ep(A(er)),ec(!0)):(ep([]),ec(!1))},[er,A]);let ef=(0,s.useMemo)(()=>$.filter(e=>{let t=e.customer_name.toLowerCase().includes(E.toLowerCase())||e.service_name.toLowerCase().includes(E.toLowerCase()),s=!U||e.status===U,a=e.appointment_date===F;return t&&s&&a}).sort((e,t)=>e.appointment_time.localeCompare(t.appointment_time)),[$,E,U,F]),eg=(0,s.useMemo)(()=>{let e=$.filter(e=>e.appointment_date===F);return{total:e.length,pending:e.filter(e=>"pending"===e.status).length,confirmed:e.filter(e=>"confirmed"===e.status).length,in_progress:e.filter(e=>"in_progress"===e.status).length,completed:e.filter(e=>"done"===e.status).length,revenue:e.filter(e=>"done"===e.status).reduce((e,t)=>e+t.total_price,0)}},[$,F]),ev=e=>{let t=new Date(F);t.setDate(t.getDate()+e),Z(t.toISOString().split("T")[0])},ey=e=>{e?(el(e),eo(e.customer_name),ex({customer_id:String(e.customer_id),customer_name:e.customer_name,customer_phone:e.customer_phone,service_id:String(e.service_id),price:String(e.price),discount:String(e.discount||0),staff_id:String(e.staff_id),appointment_date:e.appointment_date,appointment_time:e.appointment_time,notes:e.notes||""})):(el(null),eo(""),ex({customer_id:"",customer_name:"",customer_phone:"",service_id:"",price:"",discount:"0",staff_id:"",appointment_date:F,appointment_time:"09:00",notes:""})),K(!0)},eb=()=>{K(!1),el(null),eo(""),ec(!1)},ej=e=>({cash:{en:"Cash",lo:"ເງິນສົດ"},transfer:{en:"Bank Transfer",lo:"ໂອນເງິນ"},card:{en:"Credit/Debit Card",lo:"ບັດເຄຣດິດ/ເດບິດ"}})[e]?.["lo"===q?"lo":"en"]||e;return(0,t.jsx)(i.default,{children:(0,t.jsxs)("div",{className:"space-y-6 animate-fadeIn",children:[(0,t.jsx)(r.PageHeader,{title:O("appointments.title"),subtitle:"lo"===q?"ຈັດການນັດໝາຍລູກຄ້າ":"Manage customer appointments",action:(0,t.jsx)(r.Button,{icon:(0,t.jsx)(d.Plus,{className:"w-5 h-5"}),onClick:()=>ey(),children:O("appointments.add")})}),(0,t.jsx)(r.Card,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>ev(-1),className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,t.jsx)(h,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-rose-50 rounded-lg",children:[(0,t.jsx)(u.Calendar,{className:"w-5 h-5 text-rose-500"}),(0,t.jsx)("span",{className:"font-semibold text-gray-900",children:new Date(F).toLocaleDateString("lo"===q?"lo-LA":"en-US",{weekday:"long",day:"numeric",month:"long",year:"numeric"})})]}),(0,t.jsx)("button",{onClick:()=>ev(1),className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,t.jsx)(f,{className:"w-5 h-5"})}),(0,t.jsx)("input",{type:"date",value:F,onChange:e=>Z(e.target.value),className:"px-3 py-2 border rounded-lg text-sm"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,t.jsxs)("span",{className:"text-gray-500",children:["lo"===q?"ທັງໝົດ":"Total",": ",(0,t.jsx)("strong",{children:(0,o.formatNumber)(eg.total)})]}),(0,t.jsxs)("span",{className:"text-amber-600",children:["lo"===q?"ລໍຖ້າ":"Pending",": ",(0,t.jsx)("strong",{children:(0,o.formatNumber)(eg.pending)})]}),(0,t.jsxs)("span",{className:"text-blue-600",children:["lo"===q?"ກຳລັງເຮັດ":"In Progress",": ",(0,t.jsx)("strong",{children:(0,o.formatNumber)(eg.in_progress)})]}),(0,t.jsxs)("span",{className:"text-emerald-600",children:["lo"===q?"ສຳເລັດ":"Done",": ",(0,t.jsx)("strong",{children:(0,o.formatNumber)(eg.completed)})]}),(0,t.jsx)("span",{className:"text-rose-600 font-bold",children:(0,o.formatCurrency)(eg.revenue)})]})]})}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)(r.SearchInput,{value:E,onChange:X,placeholder:O("common.search")})}),(0,t.jsxs)("select",{value:U,onChange:e=>H(e.target.value),className:"px-4 py-2.5 border rounded-lg bg-white",children:[(0,t.jsxs)("option",{value:"",children:[O("common.all")," ","lo"===q?"ສະຖານະ":"Status"]}),(0,t.jsx)("option",{value:"pending",children:(0,o.getStatusText)("pending",q)}),(0,t.jsx)("option",{value:"confirmed",children:(0,o.getStatusText)("confirmed",q)}),(0,t.jsx)("option",{value:"in_progress",children:(0,o.getStatusText)("in_progress",q)}),(0,t.jsx)("option",{value:"done",children:(0,o.getStatusText)("done",q)}),(0,t.jsx)("option",{value:"cancelled",children:(0,o.getStatusText)("cancelled",q)})]})]}),(0,t.jsx)("div",{className:"space-y-3",children:0===ef.length?(0,t.jsx)(r.Card,{children:(0,t.jsx)(r.EmptyState,{icon:(0,t.jsx)(u.Calendar,{className:"w-8 h-8"}),title:"lo"===q?"ບໍ່ມີນັດໝາຍ":"No appointments",action:(0,t.jsx)(r.Button,{onClick:()=>ey(),children:O("appointments.add")})})}):ef.map(e=>{var s;return(0,t.jsx)(r.Card,{hover:!0,className:"p-0 overflow-hidden",children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsxs)("div",{className:`w-24 sm:w-28 p-4 flex flex-col items-center justify-center text-white ${"done"===e.status?"bg-gradient-to-br from-emerald-500 to-green-600":"cancelled"===e.status?"bg-gradient-to-br from-gray-400 to-gray-500":"bg-gradient-to-br from-rose-500 to-pink-500"}`,children:[(0,t.jsx)(c.Clock,{className:"w-5 h-5 mb-1 opacity-80"}),(0,t.jsx)("span",{className:"text-xl font-bold",children:e.appointment_time.substring(0,5)}),(0,t.jsxs)("span",{className:"text-xs opacity-80",children:[e.duration," ","lo"===q?"ນາທີ":"min"]})]}),(0,t.jsx)("div",{className:"flex-1 p-4",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(p.User,{className:"w-4 h-4 text-gray-400"}),(0,t.jsx)("span",{className:"font-semibold text-gray-900",children:e.customer_name}),(s=e.status,(0,t.jsx)(r.Badge,{variant:{done:"success",confirmed:"info",in_progress:"info",pending:"warning",cancelled:"danger"}[s]||"default",children:(0,o.getStatusText)(s,q)}))]}),(0,t.jsx)("p",{className:"text-sm text-rose-600 font-medium",children:"lo"===q?e.service_name_lo:e.service_name}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(m.Phone,{className:"w-3 h-3"})," ",e.customer_phone]}),(0,t.jsxs)("span",{children:["lo"===q?"ພະນັກງານ":"Staff",": ",e.staff_name]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("div",{className:"text-right mr-2",children:[(0,t.jsx)("span",{className:"text-lg font-bold text-gray-900",children:(0,o.formatCurrency)(e.total_price)}),e.discount>0&&(0,t.jsxs)("p",{className:"text-xs text-red-500",children:["-",(0,o.formatCurrency)(e.discount)]})]}),"pending"===e.status&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>B(e.id,{status:"confirmed"}),className:"p-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100",title:"lo"===q?"ຢືນຢັນ":"Confirm",children:(0,t.jsx)(v.Check,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>ey(e),className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,t.jsx)(g.Edit2,{className:"w-4 h-4 text-gray-500"})}),(0,t.jsx)("button",{onClick:()=>B(e.id,{status:"cancelled"}),className:"p-2 hover:bg-red-50 rounded-lg",children:(0,t.jsx)(y.X,{className:"w-4 h-4 text-red-500"})})]}),"confirmed"===e.status&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>B(e.id,{status:"in_progress"}),className:"p-2 bg-amber-50 text-amber-600 rounded-lg hover:bg-amber-100",title:"lo"===q?"ເລີ່ມ":"Start",children:(0,t.jsx)(b,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>ey(e),className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,t.jsx)(g.Edit2,{className:"w-4 h-4 text-gray-500"})}),(0,t.jsx)("button",{onClick:()=>B(e.id,{status:"cancelled"}),className:"p-2 hover:bg-red-50 rounded-lg",children:(0,t.jsx)(y.X,{className:"w-4 h-4 text-red-500"})})]}),"in_progress"===e.status&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Button,{size:"sm",variant:"success",icon:(0,t.jsx)(N.DollarSign,{className:"w-4 h-4"}),onClick:()=>{es(e),ei("cash"),W(!0)},children:"lo"===q?"ຮັບເງິນ":"Payment"}),(0,t.jsx)("button",{onClick:()=>B(e.id,{status:"cancelled"}),className:"p-2 hover:bg-red-50 rounded-lg",children:(0,t.jsx)(y.X,{className:"w-4 h-4 text-red-500"})})]}),"done"===e.status&&(0,t.jsx)(r.Button,{size:"sm",variant:"secondary",icon:(0,t.jsx)(j.Receipt,{className:"w-4 h-4"}),onClick:()=>{let t;(t=L.find(t=>t.appointment_id===e.id))&&(ee(t),Q(!0))},children:"lo"===q?"ໃບເສັດ":"Receipt"})]})]})})]})},e.id)})}),(0,t.jsx)(r.Modal,{isOpen:G,onClose:eb,title:O(ea?"common.edit":"appointments.add"),size:"lg",children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault();let t=P.find(e=>e.id===Number(eu.service_id)),s=T.find(e=>e.id===Number(eu.staff_id)),a=Number(eu.price),l=Number(eu.discount)||0,n={customer_id:Number(eu.customer_id),customer_name:eu.customer_name,customer_phone:eu.customer_phone,service_id:Number(eu.service_id),service_name:t?.name||"",service_name_lo:t?.name_lo||"",staff_id:Number(eu.staff_id),staff_name:s?.full_name||"",appointment_date:eu.appointment_date,appointment_time:eu.appointment_time,duration:t?.duration||60,price:a,discount:l,total_price:a-l,status:"pending",notes:eu.notes};ea?B(ea.id,n):z(n),eb()},className:"space-y-4",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[O("appointments.customer")," *"]}),(0,t.jsx)("input",{type:"text",value:er,onChange:e=>eo(e.target.value),className:"w-full px-4 py-2.5 border rounded-lg",placeholder:"lo"===q?"ຄົ້ນຫາລູກຄ້າ...":"Search customer...",required:!0}),ed&&em.length>0&&(0,t.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-60 overflow-y-auto",children:em.map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>{ex(t=>({...t,customer_id:String(e.id),customer_name:e.name,customer_phone:e.phone})),eo(e.name),ec(!1)},className:"w-full px-4 py-2 text-left hover:bg-gray-50 flex justify-between",children:[(0,t.jsx)("span",{className:"font-medium",children:e.name}),(0,t.jsx)("span",{className:"text-gray-500 text-sm",children:e.phone})]},e.id))})]}),(0,t.jsx)(r.Select,{label:O("appointments.service"),value:eu.service_id,onChange:e=>{var t;let s;return t=e.target.value,void((s=P.find(e=>e.id===Number(t)))&&ex(e=>({...e,service_id:t,price:String(s.price)})))},options:P.filter(e=>e.is_active).map(e=>({value:e.id,label:`${"lo"===q?e.name_lo:e.name} - ${(0,o.formatCurrency)(e.price)}`})),placeholder:`-- ${"lo"===q?"ເລືອກບໍລິການ":"Select Service"} --`,required:!0}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)(r.Input,{label:"lo"===q?"ລາຄາ":"Price",type:"number",value:eu.price,onChange:e=>ex({...eu,price:e.target.value}),required:!0}),(0,t.jsx)(r.Input,{label:"lo"===q?"ສ່ວນຫຼຸດ":"Discount",type:"number",value:eu.discount,onChange:e=>ex({...eu,discount:e.target.value})})]}),(0,t.jsx)(r.Select,{label:O("appointments.staff"),value:eu.staff_id,onChange:e=>ex({...eu,staff_id:e.target.value}),options:eh.map(e=>({value:e.id,label:e.full_name})),placeholder:`-- ${"lo"===q?"ເລືອກພະນັກງານ":"Select Staff"} --`,required:!0}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)(r.Input,{label:O("appointments.date"),type:"date",value:eu.appointment_date,onChange:e=>ex({...eu,appointment_date:e.target.value}),required:!0}),(0,t.jsx)(r.Input,{label:O("appointments.time"),type:"time",value:eu.appointment_time,onChange:e=>ex({...eu,appointment_time:e.target.value}),required:!0})]}),(0,t.jsx)(r.Input,{label:"lo"===q?"ໝາຍເຫດ":"Notes",value:eu.notes,onChange:e=>ex({...eu,notes:e.target.value})}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,t.jsx)(r.Button,{type:"button",variant:"secondary",className:"flex-1",onClick:eb,children:O("common.cancel")}),(0,t.jsx)(r.Button,{type:"submit",className:"flex-1",children:O("common.save")})]})]})}),(0,t.jsx)(r.Modal,{isOpen:V,onClose:()=>W(!1),title:"lo"===q?"ຮັບເງິນ":"Receive Payment",size:"md",children:et&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"bg-gray-50 p-4 rounded-xl",children:[(0,t.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"lo"===q?"ລູກຄ້າ":"Customer"}),(0,t.jsx)("span",{className:"font-medium",children:et.customer_name})]}),(0,t.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"lo"===q?"ບໍລິການ":"Service"}),(0,t.jsx)("span",{className:"font-medium",children:"lo"===q?et.service_name_lo:et.service_name})]}),(0,t.jsxs)("div",{className:"border-t pt-2 mt-2",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"lo"===q?"ລາຄາ":"Price"}),(0,t.jsx)("span",{children:(0,o.formatCurrency)(et.price)})]}),et.discount>0&&(0,t.jsxs)("div",{className:"flex justify-between text-red-600",children:[(0,t.jsx)("span",{children:"lo"===q?"ສ່ວນຫຼຸດ":"Discount"}),(0,t.jsxs)("span",{children:["-",(0,o.formatCurrency)(et.discount)]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("span",{className:"text-gray-600",children:["lo"===q?"ອາກອນ":"Tax"," (",D.tax_rate,"%)"]}),(0,t.jsx)("span",{children:(0,o.formatCurrency)(Math.round((et.price-(et.discount||0))*D.tax_rate/100))})]}),(0,t.jsxs)("div",{className:"flex justify-between text-xl font-bold mt-2 pt-2 border-t",children:[(0,t.jsx)("span",{children:"lo"===q?"ຍອດລວມ":"Total"}),(0,t.jsx)("span",{className:"text-rose-600",children:(0,o.formatCurrency)(et.price-(et.discount||0)+Math.round((et.price-(et.discount||0))*D.tax_rate/100))})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"lo"===q?"ວິທີຊຳລະ":"Payment Method"}),(0,t.jsx)("div",{className:"grid grid-cols-3 gap-2",children:[{value:"cash",label:"lo"===q?"ເງິນສົດ":"Cash",icon:C.Banknote,color:"emerald"},{value:"transfer",label:"lo"===q?"ໂອນ":"Transfer",icon:k.Building,color:"blue"},{value:"card",label:"lo"===q?"ບັດ":"Card",icon:w.CreditCard,color:"purple"}].map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>ei(e.value),className:`p-4 rounded-xl border-2 transition-all flex flex-col items-center gap-2 ${en===e.value?`border-${e.color}-500 bg-${e.color}-50`:"border-gray-200 hover:border-gray-300"}`,children:[(0,t.jsx)(e.icon,{className:`w-6 h-6 ${en===e.value?`text-${e.color}-600`:"text-gray-400"}`}),(0,t.jsx)("span",{className:`text-sm font-medium ${en===e.value?`text-${e.color}-700`:"text-gray-600"}`,children:e.label})]},e.value))})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,t.jsx)(r.Button,{type:"button",variant:"secondary",className:"flex-1",onClick:()=>W(!1),children:"lo"===q?"ຍົກເລີກ":"Cancel"}),(0,t.jsx)(r.Button,{type:"button",variant:"success",className:"flex-1",icon:(0,t.jsx)(N.DollarSign,{className:"w-5 h-5"}),onClick:()=>{if(!et)return;let e=et.price,t=et.discount||0,s=e-t,a=Math.round(s*D.tax_rate/100),l=s+a,n={id:Math.max(...L.map(e=>e.id),0)+1,bill_number:`RCP-${new Date().getFullYear()}-${String(L.length+1).padStart(5,"0")}`,appointment_id:et.id,customer_id:et.customer_id,customer_name:et.customer_name,customer_phone:et.customer_phone,service_id:et.service_id,service_name:et.service_name,service_name_lo:et.service_name_lo,staff_id:et.staff_id,staff_name:et.staff_name,subtotal:e,discount_amount:t,tax_rate:D.tax_rate,tax_amount:a,grand_total:l,payment_method:en,payment_status:"paid",notes:"",created_at:new Date().toISOString().split("T")[0],created_time:new Date().toTimeString().substring(0,5)};B(et.id,{status:"done"}),R(n),I({type:"income",category_id:0,category_name:"Service",description:`${et.service_name} - ${et.customer_name}`,amount:l,payment_method:en,bill_id:n.id,created_by:x?.id||1,created_by_name:x?.full_name||"Admin"}),W(!1),ee(n),Q(!0)},children:"lo"===q?"ຢືນຢັນການຮັບເງິນ":"Confirm Payment"})]})]})}),(0,t.jsx)(r.Modal,{isOpen:Y,onClose:()=>Q(!1),title:`${"lo"===q?"ໃບຮັບເງິນ":"Receipt"}`,size:"md",children:J&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"bg-white border rounded-xl p-6 font-mono text-sm max-h-[60vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"text-center border-b pb-4 mb-4",children:[(0,t.jsx)("h2",{className:"text-lg font-bold",children:D.shop_name}),(0,t.jsx)("p",{className:"text-gray-600",children:D.shop_name_lo}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:D.address}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:["Tel: ",D.phone]})]}),(0,t.jsxs)("div",{className:"text-center mb-4",children:[(0,t.jsx)("p",{className:"text-base font-bold",children:"lo"===q?"ໃບຮັບເງິນ":"RECEIPT"}),(0,t.jsxs)("p",{className:"text-lg font-bold text-rose-600",children:["#",J.bill_number]}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:[J.created_at," ",J.created_time||""]})]}),(0,t.jsxs)("div",{className:"border-t border-dashed pt-3 mb-3 space-y-1",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("span",{className:"text-gray-500",children:["lo"===q?"ລູກຄ້າ":"Customer",":"]}),(0,t.jsx)("span",{className:"font-medium",children:J.customer_name})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("span",{className:"text-gray-500",children:["lo"===q?"ເບີໂທ":"Phone",":"]}),(0,t.jsx)("span",{children:J.customer_phone})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("span",{className:"text-gray-500",children:["lo"===q?"ພະນັກງານ":"Staff",":"]}),(0,t.jsx)("span",{children:J.staff_name})]})]}),(0,t.jsxs)("div",{className:"border-t border-b border-dashed py-3 mb-3",children:[(0,t.jsx)("p",{className:"font-medium",children:"lo"===q?J.service_name_lo:J.service_name}),(0,t.jsx)("p",{className:"text-right font-medium",children:(0,o.formatCurrency)(J.subtotal)})]}),(0,t.jsxs)("div",{className:"space-y-1 mb-3",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"lo"===q?"ລາຄາ":"Subtotal"}),(0,t.jsx)("span",{children:(0,o.formatCurrency)(J.subtotal)})]}),J.discount_amount>0&&(0,t.jsxs)("div",{className:"flex justify-between text-red-600",children:[(0,t.jsx)("span",{children:"lo"===q?"ສ່ວນຫຼຸດ":"Discount"}),(0,t.jsxs)("span",{children:["-",(0,o.formatCurrency)(J.discount_amount)]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("span",{className:"text-gray-500",children:["lo"===q?"ອາກອນ":"VAT"," (",J.tax_rate,"%)"]}),(0,t.jsx)("span",{children:(0,o.formatCurrency)(J.tax_amount)})]})]}),(0,t.jsx)("div",{className:"bg-gray-100 -mx-6 px-6 py-3 mb-3",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-lg font-bold",children:"lo"===q?"ຍອດລວມ":"GRAND TOTAL"}),(0,t.jsx)("span",{className:"text-2xl font-bold text-rose-600",children:(0,o.formatCurrency)(J.grand_total)})]})}),(0,t.jsxs)("div",{className:"space-y-1 mb-4",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"lo"===q?"ຊຳລະດ້ວຍ":"Paid by"}),(0,t.jsx)("span",{className:"font-medium",children:ej(J.payment_method)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"lo"===q?"ສະຖານະ":"Status"}),(0,t.jsxs)("span",{className:"text-emerald-600 font-bold",children:["✓ ","lo"===q?"ຊຳລະແລ້ວ":"PAID"]})]})]}),(0,t.jsxs)("div",{className:"text-center border-t pt-4 text-xs text-gray-500",children:[(0,t.jsx)("p",{className:"font-medium",children:"lo"===q?"ຂອບໃຈທີ່ໃຊ້ບໍລິການ":"Thank you for your visit!"}),(0,t.jsx)("p",{className:"mt-2",children:"lo"===q?"ກະລຸນາເກັບໄວ້ເປັນຫຼັກຖານ":"Please keep for your records"})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 mt-4",children:[(0,t.jsx)(r.Button,{variant:"secondary",className:"flex-1",onClick:()=>Q(!1),children:"lo"===q?"ປິດ":"Close"}),(0,t.jsx)(r.Button,{className:"flex-1",icon:(0,t.jsx)(_.Printer,{className:"w-5 h-5"}),onClick:()=>{let e=window.open("","_blank");e&&J&&(e.document.write(`
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Receipt #${J.bill_number}</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { 
      font-family: 'Courier New', monospace; 
      font-size: 12px; 
      width: 80mm; 
      margin: 0 auto; 
      padding: 8mm 4mm;
      line-height: 1.4;
    }
    .center { text-align: center; }
    .right { text-align: right; }
    .bold { font-weight: bold; }
    .shop-name { font-size: 16px; font-weight: bold; margin-bottom: 2px; }
    .shop-info { font-size: 10px; color: #555; }
    .divider { border-top: 1px dashed #000; margin: 8px 0; }
    .double-divider { border-top: 2px solid #000; margin: 8px 0; }
    .bill-no { font-size: 14px; font-weight: bold; margin: 8px 0; letter-spacing: 1px; }
    .row { display: flex; justify-content: space-between; margin: 3px 0; }
    .label { color: #555; }
    .total-section { background: #f5f5f5; padding: 8px; margin: 8px -4mm; }
    .grand-total { font-size: 18px; font-weight: bold; }
    .footer { font-size: 10px; color: #555; margin-top: 12px; }
    .qr-placeholder { width: 60px; height: 60px; border: 1px dashed #999; margin: 8px auto; display: flex; align-items: center; justify-content: center; font-size: 8px; color: #999; }
  </style>
</head>
<body>
  <div class="center">
    <div class="shop-name">${D.shop_name}</div>
    <div class="shop-name">${D.shop_name_lo}</div>
    <div class="shop-info">${D.address}</div>
    <div class="shop-info">Tel: ${D.phone}</div>
  </div>
  
  <div class="divider"></div>
  
  <div class="center">
    <div style="font-size: 14px; font-weight: bold;">ໃບຮັບເງິນ / RECEIPT</div>
    <div class="bill-no">#${J.bill_number}</div>
    <div style="font-size: 10px; color: #555;">${J.created_at} ${J.created_time||""}</div>
  </div>
  
  <div class="divider"></div>
  
  <div class="row"><span class="label">${"lo"===q?"ລູກຄ້າ":"Customer"}:</span><span class="bold">${J.customer_name}</span></div>
  <div class="row"><span class="label">${"lo"===q?"ເບີໂທ":"Phone"}:</span><span>${J.customer_phone}</span></div>
  <div class="row"><span class="label">${"lo"===q?"ພະນັກງານ":"Staff"}:</span><span>${J.staff_name}</span></div>
  
  <div class="double-divider"></div>
  
  <div style="margin-bottom: 4px;">
    <div class="bold">${"lo"===q?J.service_name_lo:J.service_name}</div>
    <div class="right" style="margin-top: -14px;">${(0,o.formatCurrency)(J.subtotal)}</div>
  </div>
  
  <div class="divider"></div>
  
  <div class="row"><span class="label">${"lo"===q?"ລາຄາ":"Subtotal"}</span><span>${(0,o.formatCurrency)(J.subtotal)}</span></div>
  ${J.discount_amount>0?`<div class="row" style="color: #e11d48;"><span>${"lo"===q?"ສ່ວນຫຼຸດ":"Discount"}</span><span>-${(0,o.formatCurrency)(J.discount_amount)}</span></div>`:""}
  <div class="row"><span class="label">${"lo"===q?"ອາກອນ":"VAT"} (${J.tax_rate}%)</span><span>${(0,o.formatCurrency)(J.tax_amount)}</span></div>
  
  <div class="total-section">
    <div class="row grand-total">
      <span>${"lo"===q?"ຍອດລວມ":"GRAND TOTAL"}</span>
      <span>${(0,o.formatCurrency)(J.grand_total)}</span>
    </div>
  </div>
  
  <div class="row"><span class="label">${"lo"===q?"ຊຳລະດ້ວຍ":"Paid by"}</span><span class="bold">${ej(J.payment_method)}</span></div>
  <div class="row"><span class="label">${"lo"===q?"ສະຖານະ":"Status"}</span><span style="color: #059669;" class="bold">✓ ${"lo"===q?"ຊຳລະແລ້ວ":"PAID"}</span></div>
  
  <div class="divider"></div>
  
  <div class="center footer">
    <p>${"lo"===q?"ຂອບໃຈທີ່ໃຊ້ບໍລິການ":"Thank you for your visit!"}</p>
    <p>ເລກປະຈຳຕົວຜູ້ເສຍອາກອນ: ${D.tax_id||"XXXXXXXXXX"}</p>
    <div class="qr-placeholder">QR Code</div>
    <p style="margin-top: 8px;">--- ${"lo"===q?"ກະລຸນາເກັບໄວ້ເປັນຫຼັກຖານ":"Please keep for your records"} ---</p>
  </div>
</body>
</html>
      `),e.document.close(),setTimeout(()=>{e.print()},250))},children:"lo"===q?"ພິມໃບເສັດ":"Print Receipt"})]})]})})]})})}e.s(["default",()=>S],14531)}]);